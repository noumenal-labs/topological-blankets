{
  "timestamp": "2026-02-07T19:20:29.772273",
  "experiment_name": "interventional_structure_discovery",
  "config": {
    "n_actions": 4,
    "action_names": [
      "noop",
      "left_engine",
      "main_engine",
      "right_engine"
    ],
    "state_labels": [
      "x",
      "y",
      "vx",
      "vy",
      "angle",
      "ang_vel",
      "left_leg",
      "right_leg"
    ],
    "min_transitions_per_action": 500,
    "resampled": false,
    "transitions_per_action": {
      "noop": 1113,
      "left_engine": 1136,
      "main_engine": 1134,
      "right_engine": 1125
    },
    "tb_method": "hybrid",
    "n_objects": 2
  },
  "metrics": {
    "per_action": {
      "noop": {
        "coupling": [
          [
            0.0,
            0.2603901419972753,
            0.3817281442321884,
            0.1704948922036199,
            0.4992151931174212,
            0.04329828208992734,
            0.46030633995340636,
            0.08432931384785865
          ],
          [
            0.2603901419972753,
            0.0,
            0.0674437882741356,
            0.4029348299812672,
            0.08031109959643606,
            0.023471827749976675,
            0.5762869663713931,
            0.725624849660418
          ],
          [
            0.3817281442321884,
            0.0674437882741356,
            0.0,
            0.006273256605678002,
            0.3318501115554285,
            0.08893815232608457,
            0.0013895601655794989,
            0.19055671287714643
          ],
          [
            0.1704948922036199,
            0.4029348299812672,
            0.006273256605678002,
            0.0,
            0.09621732632053008,
            0.0415263872236826,
            0.06417829363255162,
            0.22643931397040754
          ],
          [
            0.4992151931174212,
            0.08031109959643606,
            0.3318501115554285,
            0.09621732632053008,
            0.0,
            0.5927942184679676,
            0.20457937635990675,
            0.14106198303097456
          ],
          [
            0.04329828208992734,
            0.023471827749976675,
            0.08893815232608457,
            0.0415263872236826,
            0.5927942184679676,
            0.0,
            0.28209373645369146,
            0.24506279325171887
          ],
          [
            0.46030633995340636,
            0.5762869663713931,
            0.0013895601655794989,
            0.06417829363255162,
            0.20457937635990675,
            0.28209373645369146,
            0.0,
            0.036398552713413204
          ],
          [
            0.08432931384785865,
            0.725624849660418,
            0.19055671287714643,
            0.22643931397040754,
            0.14106198303097456,
            0.24506279325171887,
            0.036398552713413204,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.028808576986193657,
          0.053094491362571716,
          0.03357022628188133,
          0.05449037253856659,
          0.03870977833867073,
          0.09807807952165604,
          0.035335905849933624,
          0.039669785648584366
        ],
        "assignment": [
          0,
          1,
          0,
          -1,
          0,
          -1,
          1,
          1
        ],
        "is_blanket": [
          false,
          false,
          false,
          true,
          false,
          true,
          false,
          false
        ],
        "eigengap": 4.999999999999995,
        "n_clusters": 1,
        "n_transitions": 1113,
        "objects": {
          "0": [
            "x",
            "vx",
            "angle"
          ],
          "1": [
            "y",
            "left_leg",
            "right_leg"
          ]
        },
        "blanket_dims": [
          "vy",
          "ang_vel"
        ]
      },
      "left_engine": {
        "coupling": [
          [
            0.0,
            0.021193873363670342,
            0.665254856967244,
            0.07450532860658372,
            0.5479289423883548,
            0.05299180367635121,
            0.0232884651515675,
            0.03320856079907656
          ],
          [
            0.021193873363670342,
            0.0,
            0.016475235429439204,
            0.44169762621445235,
            0.08891428689606205,
            0.14918158019940003,
            0.4244362997729226,
            0.5193550664736325
          ],
          [
            0.665254856967244,
            0.016475235429439204,
            0.0,
            0.20105031266095091,
            0.6874044903657143,
            0.3393285276932767,
            0.25633022978595366,
            0.31763446911750837
          ],
          [
            0.07450532860658372,
            0.44169762621445235,
            0.20105031266095091,
            0.0,
            0.2571501519745058,
            0.24200587018786443,
            0.06945751742826436,
            0.2807795644847247
          ],
          [
            0.5479289423883548,
            0.08891428689606205,
            0.6874044903657143,
            0.2571501519745058,
            0.0,
            0.6365609719165346,
            0.43521390007497124,
            0.31546640531755116
          ],
          [
            0.05299180367635121,
            0.14918158019940003,
            0.3393285276932767,
            0.24200587018786443,
            0.6365609719165346,
            0.0,
            0.6602593945947831,
            0.47293197153872285
          ],
          [
            0.0232884651515675,
            0.4244362997729226,
            0.25633022978595366,
            0.06945751742826436,
            0.43521390007497124,
            0.6602593945947831,
            0.0,
            0.41092610796224893
          ],
          [
            0.03320856079907656,
            0.5193550664736325,
            0.31763446911750837,
            0.2807795644847247,
            0.31546640531755116,
            0.47293197153872285,
            0.41092610796224893,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.03173420950770378,
          0.04510568082332611,
          0.03525063022971153,
          0.05553803965449333,
          0.037254687398672104,
          0.09805100411176682,
          0.03183898702263832,
          0.036268144845962524
        ],
        "assignment": [
          0,
          1,
          0,
          -1,
          0,
          -1,
          1,
          1
        ],
        "is_blanket": [
          false,
          false,
          false,
          true,
          false,
          true,
          false,
          false
        ],
        "eigengap": 7.999999999999994,
        "n_clusters": 1,
        "n_transitions": 1136,
        "objects": {
          "0": [
            "x",
            "vx",
            "angle"
          ],
          "1": [
            "y",
            "left_leg",
            "right_leg"
          ]
        },
        "blanket_dims": [
          "vy",
          "ang_vel"
        ]
      },
      "main_engine": {
        "coupling": [
          [
            0.0,
            0.02900362747246274,
            0.44055236722676777,
            0.06188038166528533,
            0.6429888483619884,
            0.22703819949923787,
            0.04834452413858536,
            0.02977844125036806
          ],
          [
            0.02900362747246274,
            0.0,
            0.2711673961476986,
            0.33570899905704926,
            0.10576106221083727,
            0.09080439873675321,
            0.4080624015115429,
            0.7670333652783461
          ],
          [
            0.44055236722676777,
            0.2711673961476986,
            0.0,
            0.19633652158543746,
            0.5462349205395578,
            0.40214110010966303,
            0.2665917776439913,
            0.3561033815973784
          ],
          [
            0.06188038166528533,
            0.33570899905704926,
            0.19633652158543746,
            0.0,
            0.11515960682431832,
            0.2415968136262731,
            0.004989775919221827,
            0.2502624353661178
          ],
          [
            0.6429888483619884,
            0.10576106221083727,
            0.5462349205395578,
            0.11515960682431832,
            0.0,
            0.27458168355284995,
            0.10883070465089684,
            0.12022047882819896
          ],
          [
            0.22703819949923787,
            0.09080439873675321,
            0.40214110010966303,
            0.2415968136262731,
            0.27458168355284995,
            0.0,
            0.45288400889730857,
            0.42730303478405873
          ],
          [
            0.04834452413858536,
            0.4080624015115429,
            0.2665917776439913,
            0.004989775919221827,
            0.10883070465089684,
            0.45288400889730857,
            0.0,
            0.09990047738203148
          ],
          [
            0.02977844125036806,
            0.7670333652783461,
            0.3561033815973784,
            0.2502624353661178,
            0.12022047882819896,
            0.42730303478405873,
            0.09990047738203148,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.028559783473610878,
          0.051162272691726685,
          0.05040841922163963,
          0.06596949696540833,
          0.03333894908428192,
          0.07324898988008499,
          0.03232834115624428,
          0.03456899896264076
        ],
        "assignment": [
          -1,
          0,
          1,
          0,
          -1,
          1,
          -1,
          -1
        ],
        "is_blanket": [
          true,
          false,
          false,
          false,
          true,
          false,
          true,
          true
        ],
        "eigengap": 5.9999999999999964,
        "n_clusters": 1,
        "n_transitions": 1134,
        "objects": {
          "0": [
            "y",
            "vy"
          ],
          "1": [
            "vx",
            "ang_vel"
          ]
        },
        "blanket_dims": [
          "x",
          "angle",
          "left_leg",
          "right_leg"
        ]
      },
      "right_engine": {
        "coupling": [
          [
            0.0,
            0.06637305510958096,
            0.5364562432937945,
            0.012891655681513348,
            0.6409185071868395,
            0.24342982755738332,
            0.2919053021608615,
            0.22155119987207064
          ],
          [
            0.06637305510958096,
            0.0,
            0.0023690026132688704,
            0.21697386252611106,
            0.1474600225020286,
            0.6332008967620133,
            0.6438999131998109,
            0.4209716828434044
          ],
          [
            0.5364562432937945,
            0.0023690026132688704,
            0.0,
            0.3113052078890223,
            0.6179609631394279,
            0.3450063082787412,
            0.20795442828966837,
            0.20782508309320752
          ],
          [
            0.012891655681513348,
            0.21697386252611106,
            0.3113052078890223,
            0.0,
            0.06253943127872685,
            0.13396604149263064,
            0.0258948706082947,
            0.24245641688482447
          ],
          [
            0.6409185071868395,
            0.1474600225020286,
            0.6179609631394279,
            0.06253943127872685,
            0.0,
            0.470328694293851,
            0.3522768954692288,
            0.09428549486445041
          ],
          [
            0.24342982755738332,
            0.6332008967620133,
            0.3450063082787412,
            0.13396604149263064,
            0.470328694293851,
            0.0,
            0.8225147770660469,
            0.18559193654696665
          ],
          [
            0.2919053021608615,
            0.6438999131998109,
            0.20795442828966837,
            0.0258948706082947,
            0.3522768954692288,
            0.8225147770660469,
            0.0,
            0.22054473081172285
          ],
          [
            0.22155119987207064,
            0.4209716828434044,
            0.20782508309320752,
            0.24245641688482447,
            0.09428549486445041,
            0.18559193654696665,
            0.22054473081172285,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.027568425983190536,
          0.055289413779973984,
          0.03740459680557251,
          0.05369596928358078,
          0.041600991040468216,
          0.13621234893798828,
          0.04371626302599907,
          0.03502146154642105
        ],
        "assignment": [
          1,
          0,
          1,
          0,
          1,
          -1,
          0,
          0
        ],
        "is_blanket": [
          false,
          false,
          false,
          false,
          false,
          true,
          false,
          false
        ],
        "eigengap": 5.9999999999999964,
        "n_clusters": 1,
        "n_transitions": 1125,
        "objects": {
          "0": [
            "y",
            "vy",
            "left_leg",
            "right_leg"
          ],
          "1": [
            "x",
            "vx",
            "angle"
          ]
        },
        "blanket_dims": [
          "ang_vel"
        ]
      }
    },
    "differential_coupling": {
      "coupling_variance": [
        [
          0.0,
          0.009493489305060233,
          0.011504144744308237,
          0.0032628386019609846,
          0.0038007158578987786,
          0.008795901963160326,
          0.03257254587018883,
          0.006042530091246274
        ],
        [
          0.009493489305060233,
          0.0,
          0.011603468025950088,
          0.007277233739506851,
          0.000667557097605293,
          0.05774891936038734,
          0.009998834614342679,
          0.020491122412266922
        ],
        [
          0.011504144744308237,
          0.011603468025950088,
          0.0,
          0.012031424883904896,
          0.017758441132126223,
          0.014600272997083977,
          0.011492491387451592,
          0.004961066534942491
        ],
        [
          0.0032628386019609846,
          0.007277233739506851,
          0.012031424883904896,
          0.0,
          0.005512244710895665,
          0.007001402707107051,
          0.0007179742617898639,
          0.00038986526630626695
        ],
        [
          0.0038007158578987786,
          0.000667557097605293,
          0.017758441132126223,
          0.005512244710895665,
          0.0,
          0.019696976139857242,
          0.01605282710165757,
          0.0075471188130306135
        ],
        [
          0.008795901963160326,
          0.05774891936038734,
          0.014600272997083977,
          0.007001402707107051,
          0.019696976139857242,
          0.0,
          0.041886984237892194,
          0.014483950089597696
        ],
        [
          0.03257254587018883,
          0.009998834614342679,
          0.011492491387451592,
          0.0007179742617898639,
          0.01605282710165757,
          0.041886984237892194,
          0.0,
          0.02035939040716645
        ],
        [
          0.006042530091246274,
          0.020491122412266922,
          0.004961066534942491,
          0.00038986526630626695,
          0.0075471188130306135,
          0.014483950089597696,
          0.02035939040716645,
          0.0
        ]
      ],
      "coupling_mean": [
        [
          0.0,
          0.09424017448574733,
          0.5059979029299986,
          0.07994306453925057,
          0.5827628727636509,
          0.14168952820572492,
          0.2059611578511052,
          0.09221687894234348
        ],
        [
          0.09424017448574733,
          0.0,
          0.08936385561613557,
          0.34932882944471993,
          0.105611617801341,
          0.2241646758620358,
          0.5131713952139174,
          0.6082462410639502
        ],
        [
          0.5059979029299986,
          0.08936385561613557,
          0.0,
          0.17874132468527215,
          0.5458626214000322,
          0.2938535221019414,
          0.1830664989712982,
          0.2680299116713102
        ],
        [
          0.07994306453925057,
          0.34932882944471993,
          0.17874132468527215,
          0.0,
          0.13276662909952025,
          0.16477377813261268,
          0.04113011439708313,
          0.24998443267651863
        ],
        [
          0.5827628727636509,
          0.105611617801341,
          0.5458626214000322,
          0.13276662909952025,
          0.0,
          0.4935663920578008,
          0.27522521913875087,
          0.16775859051029376
        ],
        [
          0.14168952820572492,
          0.2241646758620358,
          0.2938535221019414,
          0.16477377813261268,
          0.4935663920578008,
          0.0,
          0.5544379792529575,
          0.3327224340303668
        ],
        [
          0.2059611578511052,
          0.5131713952139174,
          0.1830664989712982,
          0.04113011439708313,
          0.27522521913875087,
          0.5544379792529575,
          0.0,
          0.1919424672173541
        ],
        [
          0.09221687894234348,
          0.6082462410639502,
          0.2680299116713102,
          0.24998443267651863,
          0.16775859051029376,
          0.3327224340303668,
          0.1919424672173541,
          0.0
        ]
      ],
      "coupling_std": [
        [
          0.0,
          0.09743453856338744,
          0.10725737617669116,
          0.05712126225812053,
          0.06164994613054239,
          0.09378647004318014,
          0.18047865765843016,
          0.07773371270720494
        ],
        [
          0.09743453856338744,
          0.0,
          0.10771939484582192,
          0.08530670395406711,
          0.025837126341861104,
          0.24031004839662312,
          0.09999417290193803,
          0.14314720539454104
        ],
        [
          0.10725737617669116,
          0.10771939484582192,
          0.0,
          0.1096878520343292,
          0.13326080118371728,
          0.12083158940063636,
          0.10720303814468876,
          0.07043483892891707
        ],
        [
          0.05712126225812053,
          0.08530670395406711,
          0.1096878520343292,
          0.0,
          0.0742444927984269,
          0.08367438501182456,
          0.026795041738908783,
          0.019745006110565448
        ],
        [
          0.06164994613054239,
          0.025837126341861104,
          0.13326080118371728,
          0.0742444927984269,
          0.0,
          0.14034591600704754,
          0.12669975178214662,
          0.08687415503491595
        ],
        [
          0.09378647004318014,
          0.24031004839662312,
          0.12083158940063636,
          0.08367438501182456,
          0.14034591600704754,
          0.0,
          0.20466309935572702,
          0.12034928371036405
        ],
        [
          0.18047865765843016,
          0.09999417290193803,
          0.10720303814468876,
          0.026795041738908783,
          0.12669975178214662,
          0.20466309935572702,
          0.0,
          0.14268633574090567
        ],
        [
          0.07773371270720494,
          0.14314720539454104,
          0.07043483892891707,
          0.019745006110565448,
          0.08687415503491595,
          0.12034928371036405,
          0.14268633574090567,
          0.0
        ]
      ],
      "variable_sensitivity": [
        0.07547216643382366,
        0.1172806245551194,
        0.0839513097057675,
        0.03619298417147158,
        0.07103588085307139,
        0.1642144074950858,
        0.1330810478804892,
        0.07427504361455672
      ],
      "action_sensitive_pairs": [
        [
          "y",
          "ang_vel",
          0.05774891936038734
        ],
        [
          "ang_vel",
          "left_leg",
          0.041886984237892194
        ],
        [
          "x",
          "left_leg",
          0.03257254587018883
        ],
        [
          "y",
          "right_leg",
          0.020491122412266922
        ],
        [
          "left_leg",
          "right_leg",
          0.02035939040716645
        ],
        [
          "angle",
          "ang_vel",
          0.019696976139857242
        ],
        [
          "vx",
          "angle",
          0.017758441132126223
        ],
        [
          "angle",
          "left_leg",
          0.01605282710165757
        ],
        [
          "vx",
          "ang_vel",
          0.014600272997083977
        ],
        [
          "ang_vel",
          "right_leg",
          0.014483950089597696
        ],
        [
          "vx",
          "vy",
          0.012031424883904896
        ],
        [
          "y",
          "vx",
          0.011603468025950088
        ],
        [
          "x",
          "vx",
          0.011504144744308237
        ],
        [
          "vx",
          "left_leg",
          0.011492491387451592
        ]
      ],
      "autonomous_pairs": [
        [
          "vy",
          "right_leg",
          0.00038986526630626695
        ],
        [
          "y",
          "angle",
          0.000667557097605293
        ],
        [
          "vy",
          "left_leg",
          0.0007179742617898639
        ],
        [
          "x",
          "vy",
          0.0032628386019609846
        ],
        [
          "x",
          "angle",
          0.0038007158578987786
        ],
        [
          "vx",
          "right_leg",
          0.004961066534942491
        ],
        [
          "vy",
          "angle",
          0.005512244710895665
        ],
        [
          "x",
          "right_leg",
          0.006042530091246274
        ],
        [
          "vy",
          "ang_vel",
          0.007001402707107051
        ],
        [
          "y",
          "vy",
          0.007277233739506851
        ],
        [
          "angle",
          "right_leg",
          0.0075471188130306135
        ],
        [
          "x",
          "ang_vel",
          0.008795901963160326
        ],
        [
          "x",
          "y",
          0.009493489305060233
        ],
        [
          "y",
          "left_leg",
          0.009998834614342679
        ]
      ],
      "variance_threshold": 0.010745663000897136
    },
    "intervention_effects": {
      "noop": [
        0.3642295369029156,
        0.29939765017987,
        0.4152938315840688,
        0.24172263728172735,
        0.2651551289080542,
        0.4459152895710323,
        0.4533970739518753,
        0.2301895988028197
      ],
      "left_engine": [
        0.2768755890272529,
        0.20213196494989832,
        0.24719118609405658,
        0.1795719723254696,
        0.3238193809049488,
        0.26986452040020675,
        0.3635404114028364,
        0.32283544209084697
      ],
      "main_engine": [
        0.22026872514028356,
        0.30255589800528526,
        0.25318961844208165,
        0.09131997926521564,
        0.2860745451510814,
        0.3315272824861666,
        0.3010740295378002,
        0.2377940552286377
      ],
      "right_engine": [
        0.2098740267605029,
        0.4970776022060925,
        0.1952634295045023,
        0.2139080911363433,
        0.16473810789546023,
        0.52467131244583,
        0.3224098057887862,
        0.2886939342784167
      ]
    },
    "effect_matrix": [
      [
        0.3642295369029156,
        0.29939765017987,
        0.4152938315840688,
        0.24172263728172735,
        0.2651551289080542,
        0.4459152895710323,
        0.4533970739518753,
        0.2301895988028197
      ],
      [
        0.2768755890272529,
        0.20213196494989832,
        0.24719118609405658,
        0.1795719723254696,
        0.3238193809049488,
        0.26986452040020675,
        0.3635404114028364,
        0.32283544209084697
      ],
      [
        0.22026872514028356,
        0.30255589800528526,
        0.25318961844208165,
        0.09131997926521564,
        0.2860745451510814,
        0.3315272824861666,
        0.3010740295378002,
        0.2377940552286377
      ],
      [
        0.2098740267605029,
        0.4970776022060925,
        0.1952634295045023,
        0.2139080911363433,
        0.16473810789546023,
        0.52467131244583,
        0.3224098057887862,
        0.2886939342784167
      ]
    ],
    "validation": {
      "main_engine_affects_vertical": {
        "main_vy_effect": 0.09131997926521564,
        "main_y_effect": 0.30255589800528526,
        "main_top_3_vars": [
          "ang_vel",
          "y",
          "left_leg"
        ],
        "passes": true
      },
      "side_engines_affect_angular": {
        "left_top_3": [
          "left_leg",
          "angle",
          "right_leg"
        ],
        "right_top_3": [
          "ang_vel",
          "y",
          "left_leg"
        ],
        "combined_top_3": [
          "ang_vel",
          "y",
          "left_leg"
        ],
        "passes": true
      },
      "actions_structurally_distinct": {
        "total_effects": {
          "noop": 2.715300747182363,
          "left_engine": 2.185830467195516,
          "main_engine": 2.023804133256552,
          "right_engine": 2.4166363100159343
        },
        "mean_pairwise_distance": 1.410084731475384,
        "main_vs_left": 1.1834827467448312,
        "main_vs_right": 1.4399941072829656,
        "main_vs_noop": 1.3242252483155914,
        "passes": true
      },
      "has_sensitive_and_autonomous": {
        "n_action_sensitive": 14,
        "n_autonomous": 14,
        "passes": true
      },
      "all_pass": true,
      "n_pass": 4,
      "n_total": 4
    }
  },
  "notes": "US-051: Interventional structure discovery via action-conditioned TB. Partitioned trajectory data by LunarLander action (noop, left engine, main engine, right engine), ran TB on each subset, and compared coupling matrices. Differential coupling (variance across actions) identifies action-sensitive variable pairs (causally downstream of intervention) vs autonomous pairs (stable coupling regardless of action). Intervention effect sizes quantify each action's causal influence. Validation: 4/4 physics checks passed."
}