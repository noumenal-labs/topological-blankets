{
  "timestamp": "2026-02-07T18:05:01.946333",
  "experiment_name": "cross_env_comparison",
  "config": {
    "cartpole_state_labels": [
      "x",
      "x_dot",
      "theta",
      "theta_dot"
    ],
    "lunarlander_state_labels": [
      "x",
      "y",
      "vx",
      "vy",
      "angle",
      "ang_vel",
      "left_leg",
      "right_leg"
    ],
    "n_ensemble": 5,
    "hidden_dim": 128,
    "n_transitions": 10000,
    "n_train_epochs": 200,
    "mpc_horizon": 10,
    "mpc_candidates": 64,
    "delta_prediction": true
  },
  "metrics": {
    "cartpole": {
      "tb_analysis": {
        "hessian_est": [
          [
            1.7730028547750186e-07,
            3.300774847639707e-07,
            -2.0155837844325648e-08,
            -8.308173655869216e-09
          ],
          [
            3.300774847639707e-07,
            7.058884940148152e-07,
            -5.496777957010883e-08,
            -5.0792573946509684e-08
          ],
          [
            -2.0155837844325648e-08,
            -5.496777957010883e-08,
            2.3053036422065658e-08,
            1.7588555684233913e-08
          ],
          [
            -8.308173655869216e-09,
            -5.0792573946509684e-08,
            1.7588555684233913e-08,
            4.204091253179232e-08
          ]
        ],
        "coupling": [
          [
            0.0,
            0.9329914187731337,
            0.315241331755916,
            0.09622397342337766
          ],
          [
            0.9329914187731337,
            0.0,
            0.43086607703132035,
            0.29482869716888294
          ],
          [
            0.315241331755916,
            0.43086607703132035,
            0.0,
            0.5649112967192315
          ],
          [
            0.09622397342337766,
            0.29482869716888294,
            0.5649112967192315,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.0007507711416110396,
          0.0018636317690834403,
          0.0008328439434990287,
          0.0010341667803004384
        ],
        "gradient_method": {
          "assignment": [
            1,
            -1,
            0,
            0
          ],
          "is_blanket": [
            false,
            true,
            false,
            false
          ]
        },
        "coupling_method": {
          "assignment": [
            0,
            0,
            -1,
            1
          ],
          "is_blanket": [
            false,
            false,
            true,
            false
          ]
        },
        "hybrid_method": {
          "assignment": [
            1,
            -1,
            0,
            0
          ],
          "is_blanket": [
            false,
            true,
            false,
            false
          ]
        },
        "eigengap": 3.9999999999999956,
        "n_clusters_spectral": 1,
        "eigenvalues": [
          2.6645352591003757e-15,
          3.9999999999999982,
          4.0,
          4.0
        ],
        "hierarchy": [
          {
            "level": 0,
            "internals": [
              1,
              2,
              3
            ],
            "blanket": [
              0
            ],
            "external": [],
            "eigengap": 3.9999999999999956,
            "n_vars": 4,
            "eigvals": [
              2.6645352591003757e-15,
              3.9999999999999982,
              4.0
            ]
          },
          {
            "level": 1,
            "internals": [
              2,
              3
            ],
            "blanket": [
              1
            ],
            "external": [],
            "eigengap": 2.999999999999998,
            "n_vars": 3,
            "eigvals": [
              2.220446049250313e-15,
              3.0
            ]
          }
        ]
      },
      "n_transitions": 10000,
      "mean_episode_length": 500.0,
      "eval_mean_length": 500.0,
      "eval_lengths": [
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500,
        500
      ],
      "final_train_loss": 3.0098215932028437e-07
    },
    "lunarlander": {
      "tb_analysis": {
        "hessian_est": [
          [
            0.004422762294509863,
            0.0009187755006744467,
            0.0032326856714227784,
            0.00035523292714204123,
            -0.003982382035208143,
            -0.0010249760260790564,
            -0.002114598919804545,
            0.0002687615770387301
          ],
          [
            0.0009187755006744467,
            0.02603025794934887,
            -0.0009291242321630144,
            -0.006623717595699509,
            -0.0004030639756195437,
            -0.02748556580810244,
            -0.012313947021997174,
            -0.011825519162765571
          ],
          [
            0.0032326856714227784,
            -0.0009291242321630144,
            0.009482952592844915,
            0.0021313189137726627,
            -0.005424343483146997,
            -0.01819929421199372,
            -0.0023701590224911007,
            0.0019564444669246204
          ],
          [
            0.00035523292714204123,
            -0.006623717595699509,
            0.0021313189137726627,
            0.014976700059215357,
            -0.00168780735421121,
            -0.012439153808231282,
            0.0006420802072728826,
            0.003729760296067914
          ],
          [
            -0.003982382035208143,
            -0.0004030639756195437,
            -0.005424343483146997,
            -0.00168780735421121,
            0.010676019144691788,
            0.03459550499084573,
            0.004167109433038592,
            -0.002126741572439405
          ],
          [
            -0.0010249760260790564,
            -0.02748556580810244,
            -0.01819929421199372,
            -0.012439153808231282,
            0.03459550499084573,
            0.43632197676733986,
            0.056884407625592256,
            -0.024548274854680995
          ],
          [
            -0.002114598919804545,
            -0.012313947021997174,
            -0.0023701590224911007,
            0.0006420802072728826,
            0.004167109433038592,
            0.056884407625592256,
            0.01970722510662839,
            -0.0027554304063641373
          ],
          [
            0.0002687615770387301,
            -0.011825519162765571,
            0.0019564444669246204,
            0.003729760296067914,
            -0.002126741572439405,
            -0.024548274854680995,
            -0.0027554304063641373,
            0.015046258552997942
          ]
        ],
        "coupling": [
          [
            0.0,
            0.0856294744960529,
            0.499165750704928,
            0.04364738690635864,
            0.5795505757721888,
            0.02333260840607205,
            0.2265000863316308,
            0.032946252356578797
          ],
          [
            0.0856294744960529,
            0.0,
            0.05913746305821656,
            0.33547058303925853,
            0.024178536359111,
            0.25790625079862745,
            0.5436823675063959,
            0.5975395528263464
          ],
          [
            0.499165750704928,
            0.05913746305821656,
            0.0,
            0.17884158207304723,
            0.5391016164791672,
            0.28293010511562944,
            0.17337755790088868,
            0.16378774179607236
          ],
          [
            0.04364738690635864,
            0.33547058303925853,
            0.17884158207304723,
            0.0,
            0.1334781132994672,
            0.15387893985604098,
            0.03737389932458984,
            0.248461169046088
          ],
          [
            0.5795505757721888,
            0.024178536359111,
            0.5391016164791672,
            0.1334781132994672,
            0.0,
            0.5068872994949076,
            0.2872879577620047,
            0.1678014506185949
          ],
          [
            0.02333260840607205,
            0.25790625079862745,
            0.28293010511562944,
            0.15387893985604098,
            0.5068872994949076,
            0.0,
            0.6134468201023523,
            0.30297244446378363
          ],
          [
            0.2265000863316308,
            0.5436823675063959,
            0.17337755790088868,
            0.03737389932458984,
            0.2872879577620047,
            0.6134468201023523,
            0.0,
            0.16001562101458747
          ],
          [
            0.032946252356578797,
            0.5975395528263464,
            0.16378774179607236,
            0.248461169046088,
            0.1678014506185949,
            0.30297244446378363,
            0.16001562101458747,
            0.0
          ]
        ],
        "grad_magnitude": [
          0.02917373925447464,
          0.051143042743206024,
          0.039186298847198486,
          0.05744368955492973,
          0.03771350160241127,
          0.10134202241897583,
          0.03578950837254524,
          0.03636939823627472
        ],
        "gradient_method": {
          "assignment": [
            1,
            0,
            1,
            0,
            1,
            -1,
            0,
            0
          ],
          "is_blanket": [
            false,
            false,
            false,
            false,
            false,
            true,
            false,
            false
          ]
        },
        "coupling_method": {
          "assignment": [
            0,
            1,
            0,
            1,
            0,
            -1,
            -1,
            1
          ],
          "is_blanket": [
            false,
            false,
            false,
            false,
            false,
            true,
            true,
            false
          ]
        },
        "hybrid_method": {
          "assignment": [
            1,
            0,
            1,
            0,
            1,
            -1,
            0,
            0
          ],
          "is_blanket": [
            false,
            false,
            false,
            false,
            false,
            true,
            false,
            false
          ]
        },
        "eigengap": 7.999999999999994,
        "n_clusters_spectral": 1,
        "eigenvalues": [
          5.329070518200751e-15,
          7.999999999999999,
          8.0,
          8.0,
          8.0,
          8.0,
          8.0,
          8.000000000000009
        ],
        "hierarchy": [
          {
            "level": 0,
            "internals": [
              0,
              3,
              4,
              5,
              6,
              7
            ],
            "blanket": [
              1,
              2
            ],
            "external": [],
            "eigengap": 7.999999999999994,
            "n_vars": 8,
            "eigvals": [
              5.329070518200751e-15,
              7.999999999999999,
              8.0,
              8.0
            ]
          },
          {
            "level": 1,
            "internals": [
              0,
              4,
              5,
              6,
              7
            ],
            "blanket": [
              3
            ],
            "external": [],
            "eigengap": 5.999999999999993,
            "n_vars": 6,
            "eigvals": [
              7.105427357601002e-15,
              6.0,
              6.0,
              6.0
            ]
          },
          {
            "level": 2,
            "internals": [
              0,
              5,
              6,
              7
            ],
            "blanket": [
              4
            ],
            "external": [],
            "eigengap": 4.999999999999994,
            "n_vars": 5,
            "eigvals": [
              2.6645352591003757e-15,
              4.9999999999999964,
              5.0,
              5.0
            ]
          }
        ]
      }
    },
    "comparison": {
      "similarity": {
        "comparisons": {
          "position_velocity_coupling": {
            "cartpole": 1.0,
            "lunarlander": 0.8137066398382231,
            "difference": 0.1862933601617769
          },
          "angular_velocity_coupling": {
            "cartpole": 0.6054839148060753,
            "lunarlander": 0.8262937925252177,
            "difference": 0.2208098777191424
          },
          "cross_domain_coupling": {
            "cartpole": 0.3047080756848871,
            "lunarlander": 0.58070025757706,
            "difference": 0.2759921818921729
          }
        },
        "structural_similarity": 0.7723015267423026,
        "norm_coupling_cartpole": [
          [
            0.0,
            1.0,
            0.33788234855412974,
            0.10313489651374327
          ],
          [
            1.0,
            0.0,
            0.46181140400830395,
            0.31600365366337146
          ],
          [
            0.33788234855412974,
            0.46181140400830395,
            0.0,
            0.6054839148060753
          ],
          [
            0.10313489651374327,
            0.31600365366337146,
            0.6054839148060753,
            0.0
          ]
        ],
        "norm_coupling_lunarlander": [
          [
            0.0,
            0.1395874453824144,
            0.8137066398382231,
            0.07115105250537636,
            0.9447446083027898,
            0.038035258544789674,
            0.36922530023684813,
            0.053706778284516636
          ],
          [
            0.1395874453824144,
            0.0,
            0.09640193920697086,
            0.5468617197873582,
            0.039414233747396166,
            0.4204215301916413,
            0.88627465281454,
            0.9740690362151494
          ],
          [
            0.8137066398382231,
            0.09640193920697086,
            0.0,
            0.2915355923488329,
            0.8788074186923314,
            0.46121374476832916,
            0.2826285053885535,
            0.26699582821008794
          ],
          [
            0.07115105250537636,
            0.5468617197873582,
            0.2915355923488329,
            0.0,
            0.21758709789578284,
            0.25084316164580756,
            0.060924432403698964,
            0.4050247892794241
          ],
          [
            0.9447446083027898,
            0.039414233747396166,
            0.8788074186923314,
            0.21758709789578284,
            0.0,
            0.8262937925252177,
            0.46831762484981393,
            0.2735387080343779
          ],
          [
            0.038035258544789674,
            0.4204215301916413,
            0.46121374476832916,
            0.25084316164580756,
            0.8262937925252177,
            0.0,
            1.0,
            0.49388542663442825
          ],
          [
            0.36922530023684813,
            0.88627465281454,
            0.2826285053885535,
            0.060924432403698964,
            0.46831762484981393,
            1.0,
            0.0,
            0.26084676906123533
          ],
          [
            0.053706778284516636,
            0.9740690362151494,
            0.26699582821008794,
            0.4050247892794241,
            0.2735387080343779,
            0.49388542663442825,
            0.26084676906123533,
            0.0
          ]
        ]
      },
      "partition_comparison": {
        "environments": {
          "cartpole": {
            "gradient_method": {
              "objects": {
                "0": [
                  "theta",
                  "theta_dot"
                ],
                "1": [
                  "x"
                ]
              },
              "blanket": [
                "x_dot"
              ],
              "n_objects": 2,
              "blanket_size": 1
            },
            "coupling_method": {
              "objects": {
                "0": [
                  "x",
                  "x_dot"
                ],
                "1": [
                  "theta_dot"
                ]
              },
              "blanket": [
                "theta"
              ],
              "n_objects": 2,
              "blanket_size": 1
            },
            "hybrid_method": {
              "objects": {
                "0": [
                  "theta",
                  "theta_dot"
                ],
                "1": [
                  "x"
                ]
              },
              "blanket": [
                "x_dot"
              ],
              "n_objects": 2,
              "blanket_size": 1
            }
          },
          "lunarlander": {
            "gradient_method": {
              "objects": {
                "0": [
                  "y",
                  "vy",
                  "left_leg",
                  "right_leg"
                ],
                "1": [
                  "x",
                  "vx",
                  "angle"
                ]
              },
              "blanket": [
                "ang_vel"
              ],
              "n_objects": 2,
              "blanket_size": 1
            },
            "coupling_method": {
              "objects": {
                "0": [
                  "x",
                  "vx",
                  "angle"
                ],
                "1": [
                  "y",
                  "vy",
                  "right_leg"
                ]
              },
              "blanket": [
                "ang_vel",
                "left_leg"
              ],
              "n_objects": 2,
              "blanket_size": 2
            },
            "hybrid_method": {
              "objects": {
                "0": [
                  "y",
                  "vy",
                  "left_leg",
                  "right_leg"
                ],
                "1": [
                  "x",
                  "vx",
                  "angle"
                ]
              },
              "blanket": [
                "ang_vel"
              ],
              "n_objects": 2,
              "blanket_size": 1
            }
          }
        },
        "shared_structure": [
          "gradient_method: CartPole angular variables (theta, theta_dot) form a single object",
          "gradient_method: LunarLander positional variables (x, vx) co-assigned",
          "coupling_method: position-velocity coupling preserved in both environments",
          "coupling_method: LunarLander positional variables (x, vx) co-assigned",
          "hybrid_method: CartPole angular variables (theta, theta_dot) form a single object",
          "hybrid_method: LunarLander positional variables (x, vx) co-assigned",
          "Coupling analysis: strong angular-velocity coupling in both environments (CartPole: 0.61, LunarLander: 0.83)",
          "Coupling analysis: position-angular cross-coupling is moderate in both (CartPole: 0.30, LunarLander: 0.58), indicating partially separable subsystems"
        ],
        "environment_specific": [
          "LunarLander has additional variables: y, vy (vertical), left_leg, right_leg (contact)",
          "CartPole has only 4 state variables vs LunarLander's 8",
          "CartPole is 1D translation + 1D rotation; LunarLander is 2D translation + 1D rotation + contacts"
        ]
      },
      "comparison_table": {
        "headers": [
          "Property",
          "CartPole",
          "LunarLander"
        ],
        "rows": [
          [
            "State dimension",
            4,
            8
          ],
          [
            "Action space",
            "2 (left/right)",
            "4 (noop/left/main/right)"
          ],
          [
            "Max coupling strength",
            "0.933",
            "0.613"
          ],
          [
            "Position-velocity coupling",
            "0.933 (x, x_dot)",
            "0.499 (x, vx)"
          ],
          [
            "Angular coupling",
            "0.565 (theta, theta_dot)",
            "0.507 (angle, ang_vel)"
          ],
          [
            "Eigengap",
            "4.000",
            "8.000"
          ],
          [
            "Spectral clusters",
            1,
            1
          ],
          [
            "N objects (hybrid)",
            2,
            2
          ],
          [
            "Blanket size (hybrid)",
            1,
            1
          ],
          [
            "Physical groupings (hybrid)",
            "{1: ['x'], -1: ['x_dot'], 0: ['theta', 'theta_dot']}",
            "{1: ['x', 'vx', 'angle'], 0: ['y', 'vy', 'left_leg', 'right_leg'], -1: ['ang_vel']}"
          ]
        ]
      },
      "discussion": {
        "transfers": [
          "Position-velocity coupling: Both environments show coupling between translational position and velocity variables, reflecting the shared physics of Newtonian kinematics (dx/dt = v).",
          "Angular-velocity coupling: Both environments couple angular position with angular velocity, reflecting rotational kinematics.",
          "Overall structural similarity (0.772) indicates that TB discovers analogous structure despite different embodiments.",
          "gradient_method: CartPole angular variables (theta, theta_dot) form a single object",
          "gradient_method: LunarLander positional variables (x, vx) co-assigned",
          "coupling_method: position-velocity coupling preserved in both environments",
          "coupling_method: LunarLander positional variables (x, vx) co-assigned",
          "hybrid_method: CartPole angular variables (theta, theta_dot) form a single object",
          "hybrid_method: LunarLander positional variables (x, vx) co-assigned",
          "Coupling analysis: strong angular-velocity coupling in both environments (CartPole: 0.61, LunarLander: 0.83)",
          "Coupling analysis: position-angular cross-coupling is moderate in both (CartPole: 0.30, LunarLander: 0.58), indicating partially separable subsystems"
        ],
        "does_not_transfer": [
          "Contact variables: LunarLander has left_leg and right_leg contact sensors with no CartPole analog. These form distinct coupling patterns.",
          "Vertical dynamics: LunarLander's y, vy variables have no CartPole counterpart. The 2D flight dynamics add a vertical object that CartPole lacks.",
          "Action complexity: LunarLander's 4-action space produces richer dynamics gradients than CartPole's binary action space.",
          "LunarLander has additional variables: y, vy (vertical), left_leg, right_leg (contact)",
          "CartPole has only 4 state variables vs LunarLander's 8",
          "CartPole is 1D translation + 1D rotation; LunarLander is 2D translation + 1D rotation + contacts"
        ],
        "interpretation": "The structural similarity of 0.772 between CartPole and LunarLander TB partitions supports the hypothesis that shared physical symmetries (position-velocity kinematics, angular dynamics) produce shared blanket structure. The position-velocity and angle-angular_velocity pairs in both environments serve analogous roles, with coupling strengths that reflect the shared Newtonian physics underlying both systems. Environment-specific variables (vertical dynamics, contact sensors) appear as additional structure in LunarLander that has no CartPole analog, demonstrating that TB correctly identifies both shared and unique structural features across embodiments."
      }
    }
  },
  "notes": "US-055: Cross-environment TB comparison. CartPole vs LunarLander. Tests whether TB discovers analogous structure across different environments."
}