{
  "timestamp": "2026-02-07T19:54:44.823834",
  "experiment_name": "ksd_partition_validation",
  "config": {
    "n_permutations": 500,
    "max_samples": 300,
    "quadratic_config": {
      "n_objects": 2,
      "vars_per_object": 3,
      "vars_per_blanket": 3,
      "intra_strength": 6.0,
      "blanket_strength": 0.8,
      "n_samples": 3000
    }
  },
  "metrics": {
    "quadratic_validation": {
      "config": {
        "n_objects": 2,
        "vars_per_object": 3,
        "vars_per_blanket": 3,
        "intra_strength": 6.0,
        "blanket_strength": 0.8,
        "n_samples": 3000
      },
      "correct_partition": {
        "idx_A": [
          0,
          1,
          2
        ],
        "idx_B": [
          3,
          4,
          5
        ],
        "idx_M": [
          6,
          7,
          8
        ],
        "test_stat_AB": 1.5501035492819908e-14,
        "test_stat_BA": 1.513385741234377e-14,
        "p_value_AB": 1.0,
        "p_value_BA": 1.0,
        "p_value": 1.0,
        "reject_at_005": false,
        "time": 0.499194860458374
      },
      "random_partition": {
        "idx_A": [
          7,
          0,
          5
        ],
        "idx_B": [
          6,
          3,
          1
        ],
        "idx_M": [
          8,
          4,
          2
        ],
        "test_stat_AB": 8.692525524840294,
        "test_stat_BA": 8.692525524840288,
        "p_value_AB": 0.0,
        "p_value_BA": 0.0,
        "p_value": 0.0,
        "reject_at_005": true,
        "time": 0.6542437076568604
      },
      "tb_detected_partition": {
        "idx_A": [
          0,
          1,
          2,
          7
        ],
        "idx_B": [
          3,
          4,
          5
        ],
        "idx_M": [
          6,
          8
        ],
        "test_stat_AB": 1.3856406460551005,
        "test_stat_BA": 1.3856406460550998,
        "p_value_AB": 1.0,
        "p_value_BA": 1.0,
        "p_value": 1.0,
        "reject_at_005": false,
        "time": 0.7438991069793701
      }
    },
    "power_analysis": {
      "100": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.75,
        "correct_mean_pvalue": 1.0,
        "correct_std_pvalue": 0.0,
        "random_mean_pvalue": 0.18958333333333333,
        "random_std_pvalue": 0.3498945773769262,
        "correct_pvals": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.0,
          0.0,
          0.5166666666666667,
          0.0,
          0.0,
          1.0,
          0.0,
          0.0
        ]
      },
      "200": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.875,
        "correct_mean_pvalue": 1.0,
        "correct_std_pvalue": 0.0,
        "random_mean_pvalue": 0.125,
        "random_std_pvalue": 0.33071891388307384,
        "correct_pvals": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          1.0,
          0.0,
          0.0
        ]
      },
      "500": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 1.0,
        "correct_mean_pvalue": 1.0,
        "correct_std_pvalue": 0.0,
        "random_mean_pvalue": 0.0008333333333333334,
        "random_std_pvalue": 0.0022047927592204926,
        "correct_pvals": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.0,
          0.0,
          0.006666666666666667,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "1000": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.875,
        "correct_mean_pvalue": 1.0,
        "correct_std_pvalue": 0.0,
        "random_mean_pvalue": 0.0975,
        "random_std_pvalue": 0.2579607528287976,
        "correct_pvals": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.0,
          0.0,
          0.78,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "2000": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.75,
        "correct_mean_pvalue": 1.0,
        "correct_std_pvalue": 0.0,
        "random_mean_pvalue": 0.13958333333333334,
        "random_std_pvalue": 0.32744141757640316,
        "correct_pvals": [
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.0,
          0.0,
          0.11666666666666667,
          0.0,
          0.0,
          1.0,
          0.0,
          0.0
        ]
      }
    },
    "lunarlander_validation": {
      "n_samples": 2000,
      "n_vars": 8,
      "state_labels": [
        "x",
        "y",
        "vx",
        "vy",
        "angle",
        "ang_vel",
        "left_leg",
        "right_leg"
      ],
      "data_source": "synthetic_lunarlander_8d",
      "tb_partition": {
        "assignment": [
          -1,
          0,
          -1,
          0,
          1,
          -1,
          -1,
          0
        ],
        "is_blanket": [
          true,
          false,
          true,
          false,
          false,
          true,
          true,
          false
        ],
        "blanket_vars": [
          0,
          2,
          5,
          6
        ]
      },
      "tb_validation": {
        "partition_valid": false,
        "min_pvalue": 0.0,
        "mean_pvalue": 0.0,
        "pair_results": {
          "obj0_vs_obj1": {
            "test_stat_AB": 0.5000000000000004,
            "test_stat_BA": 0.5000000000000013,
            "test_stat_combined": 1.0000000000000018,
            "p_value_AB": 0.0,
            "p_value_BA": 0.0,
            "combined_p_value": 0.0,
            "n_samples_used": 300,
            "dim_A": 3,
            "dim_B": 1,
            "dim_M": 4,
            "reject_at_005": true,
            "reject_at_001": true,
            "n_bootstrap": 300,
            "beta_B_frob": 0.5000000000000004,
            "beta_A_frob": 0.5000000000000013,
            "perm_stats_mean": 0.6658023200971596,
            "perm_stats_std": 0.023408271941772568
          }
        }
      },
      "random_validation": {
        "partition_valid": false,
        "min_pvalue": 0.0,
        "mean_pvalue": 0.0,
        "pair_results": {
          "obj0_vs_obj1": {
            "test_stat_AB": 4.1533119314590365,
            "test_stat_BA": 4.153311931459037,
            "test_stat_combined": 8.306623862918073,
            "p_value_AB": 0.0,
            "p_value_BA": 0.0,
            "combined_p_value": 0.0,
            "n_samples_used": 300,
            "dim_A": 3,
            "dim_B": 3,
            "dim_M": 2,
            "reject_at_005": true,
            "reject_at_001": true,
            "n_bootstrap": 300,
            "beta_B_frob": 4.1533119314590365,
            "beta_A_frob": 4.153311931459037,
            "perm_stats_mean": 0.979557708894019,
            "perm_stats_std": 0.0938036751455209
          }
        }
      }
    },
    "integration_test": {
      "partition_valid": true,
      "mean_pvalue": 1.0,
      "min_pvalue": 1.0
    },
    "summary": {
      "acceptance_criteria": {
        "correct_partition_not_rejected": true,
        "random_partition_rejected": true,
        "tb_partition_not_rejected": true,
        "power_crossover_N": 200,
        "integration_works": true
      },
      "total_time_seconds": 77.4502944946289
    }
  },
  "notes": "US-074: KSD goodness-of-fit test. Correct p=1.0000 (not_rej=True), random p=0.0000 (rej=True), TB p=1.0000 (not_rej=True). Power crossover N=200. Integration: valid=True."
}