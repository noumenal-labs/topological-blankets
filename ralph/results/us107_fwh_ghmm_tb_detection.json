{
  "experiment": "US-107",
  "title": "GHMM Factored Representations with TB Detection",
  "reference": "Shai et al. 2602.02385v1",
  "factor_info": {
    "n_factors": 5,
    "factor_types": [
      "Mess3",
      "Mess3",
      "Mess3",
      "BlochWalk",
      "BlochWalk"
    ],
    "factor_alphabets": [
      3,
      3,
      3,
      4,
      4
    ],
    "factor_latent_dims": [
      3,
      3,
      3,
      4,
      4
    ],
    "vocab_size": 433,
    "factored_dim": 12,
    "joint_dim": 431
  },
  "model": {
    "architecture": "GPT-2",
    "n_layers": 4,
    "d_model": 120,
    "d_mlp": 480,
    "n_heads": 4,
    "vocab_size": 433,
    "n_params": 749640
  },
  "training": {
    "n_sequences": 10000,
    "seq_len": 8,
    "n_epochs": 30,
    "batch_size": 256,
    "lr": 0.001,
    "final_loss": 3.839248,
    "loss_history": [
      6.084123,
      6.07578,
      6.073197,
      6.070944,
      6.066957,
      6.061985,
      6.052799,
      6.037254,
      6.015441,
      5.984822,
      5.95098,
      5.913095,
      5.869297,
      5.823663,
      5.77306,
      5.718825,
      5.660886,
      5.592959,
      5.518503,
      5.438391,
      5.344086,
      5.240669,
      5.121993,
      4.993034,
      4.834146,
      4.670384,
      4.482259,
      4.283005,
      4.068715,
      3.839248
    ]
  },
  "tb_results": {
    "embedding": {
      "eigengap": 91.4522064262499,
      "n_objects_detected": 5,
      "n_blanket": 15,
      "eigenvalues_top20": [
        -1.5631940186722204e-13,
        91.45220642624975,
        92.23901124356324,
        93.97750214284136,
        94.57436720427901,
        94.85655573076997,
        95.39142713516081,
        95.86526164210032,
        96.26344708876994,
        96.52442464746478,
        96.61415607504213,
        97.09204945609294,
        97.19005416002886,
        97.47046175470565,
        97.97859009780343,
        98.03242235557181,
        98.45673052651955,
        98.52452623326921,
        98.64675481439409,
        99.00065534476987
      ],
      "runtime_s": 2.354
    },
    "layer_1": {
      "eigengap": 101.0239920655381,
      "n_objects_detected": 5,
      "n_blanket": 3,
      "eigenvalues_top20": [
        -7.105427357601002e-14,
        101.02399206553802,
        102.54852431023902,
        103.77893800171714,
        104.62576048630184,
        105.09488254054166,
        105.63389715282881,
        105.68090528465275,
        105.90836299426523,
        106.4777616003289,
        106.60236999425523,
        106.84834473847226,
        107.01124348321356,
        107.16144426626455,
        107.57213036779288,
        107.69525221852608,
        107.76439453455868,
        107.82613880191192,
        108.28002072018853,
        108.47260708223341
      ],
      "runtime_s": 0.119
    },
    "layer_2": {
      "eigengap": 100.92541072291817,
      "n_objects_detected": 5,
      "n_blanket": 5,
      "eigenvalues_top20": [
        -4.68914480757586e-298,
        100.92541072291817,
        101.26757133130761,
        101.82177884148777,
        101.9345602142335,
        102.3201501911306,
        102.51502453354159,
        102.69527644916704,
        102.82287074226441,
        103.01959357012115,
        103.59127443504053,
        103.75055807000426,
        103.8628255685322,
        103.9058360975665,
        104.10609819228569,
        104.40791853848323,
        104.50338941271153,
        104.60907276451064,
        104.85045229200279,
        105.08792388411439
      ],
      "runtime_s": 0.128
    },
    "layer_3": {
      "eigengap": 97.42356883636108,
      "n_objects_detected": 5,
      "n_blanket": 13,
      "eigenvalues_top20": [
        -1.4210854715202004e-13,
        97.42356883636094,
        97.9623077898222,
        98.74012304464087,
        99.1272657693825,
        99.53606724365311,
        99.77728299699636,
        100.4529004575701,
        100.70946907177849,
        100.77656744674134,
        100.90606495618744,
        101.18935037270217,
        101.45927359218985,
        101.80073807809119,
        101.93641858049283,
        102.19447589874402,
        102.36051697724271,
        102.43597749384807,
        102.54460692440439,
        102.72362642883009
      ],
      "runtime_s": 0.103
    },
    "layer_4": {
      "eigengap": 93.85481628154035,
      "n_objects_detected": 5,
      "n_blanket": 2,
      "eigenvalues_top20": [
        7.105427357601002e-14,
        93.85481628154042,
        95.69368115849844,
        96.65261706346935,
        97.24483918745734,
        98.61228388732926,
        98.90717980821029,
        99.61561525424418,
        99.74530520864575,
        99.91777187619056,
        99.95445785225733,
        100.27593538382092,
        100.32759955473513,
        100.69674047980598,
        101.08567991642778,
        101.3971319377429,
        101.43435422818648,
        101.60957334458433,
        101.82609865410336,
        102.00641909914205
      ],
      "runtime_s": 0.103
    }
  },
  "pca_results": {
    "embedding": {
      "dims_for_95_pct": 51,
      "explained_variance_top20": [
        0.027390681207180023,
        0.05263589322566986,
        0.07713066041469574,
        0.09908982366323471,
        0.12006714940071106,
        0.1407417505979538,
        0.16057142615318298,
        0.18014387786388397,
        0.1987657994031906,
        0.21665769815444946,
        0.23378834128379822,
        0.25080496072769165,
        0.2674202024936676,
        0.28338998556137085,
        0.2991870939731598,
        0.3144306242465973,
        0.3296221196651459,
        0.3441263437271118,
        0.35820773243904114,
        0.37201738357543945
      ]
    },
    "layer_1": {
      "dims_for_95_pct": 51,
      "explained_variance_top20": [
        0.06762959063053131,
        0.12597396969795227,
        0.17629417777061462,
        0.22165392339229584,
        0.25999581813812256,
        0.2962375581264496,
        0.3303525149822235,
        0.3616604208946228,
        0.3898187279701233,
        0.41540035605430603,
        0.4399925172328949,
        0.46354642510414124,
        0.48648300766944885,
        0.508052408695221,
        0.5286308526992798,
        0.5474758148193359,
        0.5657872557640076,
        0.5817919969558716,
        0.596778392791748,
        0.6116445660591125
      ]
    },
    "layer_2": {
      "dims_for_95_pct": 51,
      "explained_variance_top20": [
        0.04635452479124069,
        0.0871841236948967,
        0.1252313256263733,
        0.16215258836746216,
        0.19388103485107422,
        0.2241925448179245,
        0.25295311212539673,
        0.2807048261165619,
        0.30514565110206604,
        0.3277376592159271,
        0.34886643290519714,
        0.3690537214279175,
        0.3882680833339691,
        0.407199889421463,
        0.424906849861145,
        0.4422326385974884,
        0.4589299261569977,
        0.4746052026748657,
        0.48978662490844727,
        0.5042144060134888
      ]
    },
    "layer_3": {
      "dims_for_95_pct": 51,
      "explained_variance_top20": [
        0.03877635672688484,
        0.07265439629554749,
        0.10310947149991989,
        0.13249684870243073,
        0.16005419194698334,
        0.18503637611865997,
        0.20936372876167297,
        0.2330387681722641,
        0.255961149930954,
        0.27771666646003723,
        0.29790961742401123,
        0.3170071542263031,
        0.3354659378528595,
        0.3528861999511719,
        0.37018686532974243,
        0.386501669883728,
        0.40251126885414124,
        0.41735324263572693,
        0.43185022473335266,
        0.44595885276794434
      ]
    },
    "layer_4": {
      "dims_for_95_pct": 51,
      "explained_variance_top20": [
        0.037433695048093796,
        0.07023946940898895,
        0.10102252662181854,
        0.12863940000534058,
        0.1542368233203888,
        0.17865107953548431,
        0.2010299116373062,
        0.22246472537517548,
        0.24317584931850433,
        0.26309511065483093,
        0.2826636731624603,
        0.30113133788108826,
        0.31884855031967163,
        0.3364061713218689,
        0.3527063727378845,
        0.3683328628540039,
        0.3831641376018524,
        0.3973116874694824,
        0.41126957535743713,
        0.42500776052474976
      ]
    }
  },
  "comparison": {
    "embedding": {
      "nmi_tb_vs_pca": 0.1137,
      "ari_tb_vs_pca": 0.0364,
      "tb_eigengap": 91.4522,
      "tb_n_objects": 5,
      "tb_n_blanket": 15,
      "pca_dims_95": 51
    },
    "layer_1": {
      "nmi_tb_vs_pca": 0.0799,
      "ari_tb_vs_pca": 0.0193,
      "tb_eigengap": 101.024,
      "tb_n_objects": 5,
      "tb_n_blanket": 3,
      "pca_dims_95": 51
    },
    "layer_2": {
      "nmi_tb_vs_pca": 0.1303,
      "ari_tb_vs_pca": 0.0602,
      "tb_eigengap": 100.9254,
      "tb_n_objects": 5,
      "tb_n_blanket": 5,
      "pca_dims_95": 51
    },
    "layer_3": {
      "nmi_tb_vs_pca": 0.118,
      "ari_tb_vs_pca": 0.0454,
      "tb_eigengap": 97.4236,
      "tb_n_objects": 5,
      "tb_n_blanket": 13,
      "pca_dims_95": 51
    },
    "layer_4": {
      "nmi_tb_vs_pca": 0.1558,
      "ari_tb_vs_pca": 0.0755,
      "tb_eigengap": 93.8548,
      "tb_n_objects": 5,
      "tb_n_blanket": 2,
      "pca_dims_95": 51
    }
  },
  "summary": {
    "tb_detects_factored_structure": true,
    "max_eigengap": 101.0239920655381,
    "max_eigengap_layer": "layer_1",
    "min_pca_dims_95": 51,
    "factored_dim_prediction": 12
  }
}