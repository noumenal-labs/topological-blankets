{
  "timestamp": "2026-02-07T17:37:36.156570",
  "experiment_name": "diffusion_tb_analysis",
  "config": {
    "dataset": "make_moons",
    "n_samples": 1000,
    "noise": 0.08,
    "T": 100,
    "beta_min": 0.0001,
    "beta_max": 0.02,
    "score_model": "MLPRegressor(256,256,128)",
    "parameterization": "epsilon (predict noise)",
    "n_sigma_levels": 10,
    "n_augment": 8,
    "sample_sub_n": 400,
    "bandwidth": "20th_percentile",
    "laplacian": "normalized",
    "score_normalization": "unit_direction"
  },
  "metrics": {
    "sigma_levels": [
      0.009999999999999449,
      0.11989154836678584,
      0.22769565097971833,
      0.33152602019891175,
      0.4296887606445435,
      0.5207607537537945,
      0.6036483108697694,
      0.6776222798065362,
      0.7423278904506586,
      0.7977698615167834
    ],
    "per_sigma": {
      "sigma_0.0100": {
        "sigma": 0.009999999999999449,
        "sample_eigengap": 0.2396931020061035,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.967582315084655e-13,
          0.12485358194743179,
          0.2430426910525435,
          0.482735793058647,
          0.5728646422387442,
          0.7795907968609483,
          0.796738275510733,
          0.9229518697548494,
          0.9344724630941658,
          0.9861859081987817,
          0.9868808908646053
        ],
        "var_hessian_est": [
          [
            144.03458768183916,
            -22.527391297730063
          ],
          [
            -22.527391297730063,
            78.51992671185462
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.21183004684006046
          ],
          [
            0.21183004684006046,
            0.0
          ]
        ],
        "var_coupling_strength": 0.21183004684006046,
        "ari": 0.0473941317605944
      },
      "sigma_0.1199": {
        "sigma": 0.11989154836678584,
        "sample_eigengap": 0.27550437610864864,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.696687897076117e-13,
          0.1549007961830996,
          0.2720652606163314,
          0.54756963672498,
          0.634703436311393,
          0.8356738204349193,
          0.8518122814256011,
          0.9544709509104305,
          0.9604228333228702,
          0.9959354773532442,
          0.997833809168316
        ],
        "var_hessian_est": [
          [
            22.031298486006627,
            0.20431917156071056
          ],
          [
            0.20431917156071056,
            11.737414243464247
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.012705824534091057
          ],
          [
            0.012705824534091057,
            0.0
          ]
        ],
        "var_coupling_strength": 0.012705824534091057,
        "ari": 0.00316765267620068
      },
      "sigma_0.2277": {
        "sigma": 0.22769565097971833,
        "sample_eigengap": 0.30544403350579674,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.525713551283843e-13,
          0.172437359296444,
          0.26786678639299233,
          0.5733108198987891,
          0.6375190814700022,
          0.8272009626942829,
          0.8783967897457413,
          0.9580034184924928,
          0.9687648856886778,
          0.998330023092558,
          0.9985485462439759
        ],
        "var_hessian_est": [
          [
            7.005471315170341,
            -0.04653813076105492
          ],
          [
            -0.04653813076105492,
            4.804118498118217
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.008022013652704215
          ],
          [
            0.008022013652704215,
            0.0
          ]
        ],
        "var_coupling_strength": 0.008022013652704215,
        "ari": -0.0030311191377680614
      },
      "sigma_0.3315": {
        "sigma": 0.33152602019891175,
        "sample_eigengap": 0.3134539436986361,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.563461134121098e-13,
          0.17830832409917907,
          0.2632529392261618,
          0.5767068829247979,
          0.6280633878381559,
          0.8289041937798386,
          0.8738547274676383,
          0.9596968045631704,
          0.9655646712623513,
          0.997519927757519,
          0.9983502386960005
        ],
        "var_hessian_est": [
          [
            2.992896067987178,
            0.07717529735743013
          ],
          [
            0.07717529735743013,
            2.835154047691181
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.026493794170277363
          ],
          [
            0.026493794170277363,
            0.0
          ]
        ],
        "var_coupling_strength": 0.026493794170277363,
        "ari": 0.005109383647042767
      },
      "sigma_0.4297": {
        "sigma": 0.4296887606445435,
        "sample_eigengap": 0.2825193227737782,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.618972285352356e-13,
          0.17662463797957229,
          0.26467457452534493,
          0.5471938972991232,
          0.6370081341537417,
          0.8431645864180337,
          0.8577488838328461,
          0.9573328133313411,
          0.9640006052896729,
          0.9970219750115744,
          0.9976578081551584
        ],
        "var_hessian_est": [
          [
            1.8110456458304118,
            0.05130498746171479
          ],
          [
            0.05130498746171479,
            2.0582501559919453
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.02657331910816054
          ],
          [
            0.02657331910816054,
            0.0
          ]
        ],
        "var_coupling_strength": 0.02657331910816054,
        "ari": 0.010882465711519794
      },
      "sigma_0.5208": {
        "sigma": 0.5207607537537945,
        "sample_eigengap": 0.22331346857702505,
        "sample_n_clusters": 3,
        "sample_eigenvalues": [
          9.954259638789154e-13,
          0.0948045922471602,
          0.3174982543955298,
          0.5408117229725549,
          0.585297649948461,
          0.7937945986618105,
          0.8359964962785559,
          0.9383982440418985,
          0.9491580967890373,
          0.9900389081588878,
          0.9935647864010702
        ],
        "var_hessian_est": [
          [
            1.3139199241036523,
            0.211934333075169
          ],
          [
            0.211934333075169,
            1.4256168746649418
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.15485151094509264
          ],
          [
            0.15485151094509264,
            0.0
          ]
        ],
        "var_coupling_strength": 0.15485151094509264,
        "ari": 0.01490920180304517
      },
      "sigma_0.6036": {
        "sigma": 0.6036483108697694,
        "sample_eigengap": 0.25999354998858115,
        "sample_n_clusters": 2,
        "sample_eigenvalues": [
          1.0731415756026763e-12,
          0.03251116879366078,
          0.29250471878224193,
          0.40041423109027396,
          0.5381573358262886,
          0.6984732399170943,
          0.7405057635412728,
          0.8744107853549988,
          0.8861219730001101,
          0.9614561881104218,
          0.9628429462508747
        ],
        "var_hessian_est": [
          [
            1.1575060408661106,
            0.2661724676493658
          ],
          [
            0.2661724676493658,
            1.391799910106933
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.20970707755149573
          ],
          [
            0.20970707755149573,
            0.0
          ]
        ],
        "var_coupling_strength": 0.20970707755149573,
        "ari": 0.0017246204073171996
      },
      "sigma_0.6776": {
        "sigma": 0.6776222798065362,
        "sample_eigengap": 0.24403279969642921,
        "sample_n_clusters": 2,
        "sample_eigenvalues": [
          1.0591527654923993e-12,
          0.03736847605487359,
          0.2814012757513028,
          0.39713213212462006,
          0.560878901983481,
          0.7137829897762955,
          0.7625725021008916,
          0.8726407484734445,
          0.9117171919252939,
          0.9682917175968141,
          0.9705443434414821
        ],
        "var_hessian_est": [
          [
            1.1055207877522337,
            0.18911666059888946
          ],
          [
            0.18911666059888946,
            1.175017660845652
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.16592970025445272
          ],
          [
            0.16592970025445272,
            0.0
          ]
        ],
        "var_coupling_strength": 0.16592970025445272,
        "ari": 0.023155685806288216
      },
      "sigma_0.7423": {
        "sigma": 0.7423278904506586,
        "sample_eigengap": 0.21315383676365618,
        "sample_n_clusters": 2,
        "sample_eigenvalues": [
          1.020961093445294e-12,
          0.08213316137852134,
          0.2952869981421775,
          0.4767389572073789,
          0.6004599911824,
          0.7932853143605004,
          0.806036607412013,
          0.9279974546226571,
          0.9379754161869818,
          0.9864157377267767,
          0.9888279587477341
        ],
        "var_hessian_est": [
          [
            1.1370686972848492,
            0.23155599227148307
          ],
          [
            0.23155599227148307,
            1.0816121747448328
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.2087982625706976
          ],
          [
            0.2087982625706976,
            0.0
          ]
        ],
        "var_coupling_strength": 0.2087982625706976,
        "ari": 0.01576125802125358
      },
      "sigma_0.7978": {
        "sigma": 0.7977698615167834,
        "sample_eigengap": 0.21877803040677246,
        "sample_n_clusters": 5,
        "sample_eigenvalues": [
          1.0018652574217413e-12,
          0.09917311435909593,
          0.3034529825380565,
          0.5178903361119386,
          0.5960115165312068,
          0.8147895469379792,
          0.8191117798659732,
          0.9389091981237521,
          0.946597219558456,
          0.9901637079432424,
          0.9922773367501003
        ],
        "var_hessian_est": [
          [
            1.0197799211636653,
            0.12527832187472818
          ],
          [
            0.12527832187472818,
            1.0172124425371063
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.12300332700094568
          ],
          [
            0.12300332700094568,
            0.0
          ]
        ],
        "var_coupling_strength": 0.12300332700094568,
        "ari": 0.08395645581182057
      }
    },
    "structure_emergence": {
      "clusters_vs_sigma": [
        [
          0.009999999999999449,
          3
        ],
        [
          0.11989154836678584,
          3
        ],
        [
          0.22769565097971833,
          3
        ],
        [
          0.33152602019891175,
          3
        ],
        [
          0.4296887606445435,
          3
        ],
        [
          0.5207607537537945,
          3
        ],
        [
          0.6036483108697694,
          2
        ],
        [
          0.6776222798065362,
          2
        ],
        [
          0.7423278904506586,
          2
        ],
        [
          0.7977698615167834,
          5
        ]
      ],
      "eigengap_vs_sigma": [
        [
          0.009999999999999449,
          0.2396931020061035
        ],
        [
          0.11989154836678584,
          0.27550437610864864
        ],
        [
          0.22769565097971833,
          0.30544403350579674
        ],
        [
          0.33152602019891175,
          0.3134539436986361
        ],
        [
          0.4296887606445435,
          0.2825193227737782
        ],
        [
          0.5207607537537945,
          0.22331346857702505
        ],
        [
          0.6036483108697694,
          0.25999354998858115
        ],
        [
          0.6776222798065362,
          0.24403279969642921
        ],
        [
          0.7423278904506586,
          0.21315383676365618
        ],
        [
          0.7977698615167834,
          0.21877803040677246
        ]
      ],
      "ari_vs_sigma": [
        [
          0.009999999999999449,
          0.0473941317605944
        ],
        [
          0.11989154836678584,
          0.00316765267620068
        ],
        [
          0.22769565097971833,
          -0.0030311191377680614
        ],
        [
          0.33152602019891175,
          0.005109383647042767
        ],
        [
          0.4296887606445435,
          0.010882465711519794
        ],
        [
          0.5207607537537945,
          0.01490920180304517
        ],
        [
          0.6036483108697694,
          0.0017246204073171996
        ],
        [
          0.6776222798065362,
          0.023155685806288216
        ],
        [
          0.7423278904506586,
          0.01576125802125358
        ],
        [
          0.7977698615167834,
          0.08395645581182057
        ]
      ],
      "coupling_vs_sigma": [
        [
          0.009999999999999449,
          0.21183004684006046
        ],
        [
          0.11989154836678584,
          0.012705824534091057
        ],
        [
          0.22769565097971833,
          0.008022013652704215
        ],
        [
          0.33152602019891175,
          0.026493794170277363
        ],
        [
          0.4296887606445435,
          0.02657331910816054
        ],
        [
          0.5207607537537945,
          0.15485151094509264
        ],
        [
          0.6036483108697694,
          0.20970707755149573
        ],
        [
          0.6776222798065362,
          0.16592970025445272
        ],
        [
          0.7423278904506586,
          0.2087982625706976
        ],
        [
          0.7977698615167834,
          0.12300332700094568
        ]
      ]
    },
    "topological_transition_sigma": 0.475224757199169,
    "comparison_to_us019": {
      "us019_ari": 0.05568930866486918,
      "us019_eigengap": 0.246912978714539,
      "us019_n_clusters": 3,
      "us019_coupling_strength": 0.029343740092034703,
      "best_ddpm_ari": 0.08395645581182057,
      "best_ddpm_sigma": 0.7977698615167834,
      "ddpm_better": true
    },
    "acceptance": {
      "high_noise_1_cluster": false,
      "low_noise_2_clusters": false,
      "eigengap_increases_at_low_noise": true,
      "low_noise_ari_positive": true,
      "transition_sigma_found": true
    }
  },
  "notes": "US-052: TB applied to DDPM epsilon model at multiple noise levels. Structure crystallizes from noise along the reverse diffusion trajectory. Uses normalized Laplacian with 20th-percentile bandwidth on unit-normalized score vectors for robust cluster detection."
}