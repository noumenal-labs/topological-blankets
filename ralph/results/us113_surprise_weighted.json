{
  "experiment": "US-113",
  "title": "Surprise-Weighted Learning with TB Decomposition",
  "training": {
    "n_sequences": 10000,
    "n_epochs": 30,
    "surprise_scale": 2.0,
    "partition_update_every": 5
  },
  "baseline": {
    "final_loss": 3.29719,
    "loss_curve": [
      6.083464,
      6.074961,
      6.072757,
      6.069951,
      6.065074,
      6.056119,
      6.039006,
      6.013265,
      5.981034,
      5.94279,
      5.903782,
      5.856348,
      5.805246,
      5.752994,
      5.690593,
      5.62167,
      5.544503,
      5.459514,
      5.362736,
      5.254136,
      5.125594,
      4.984136,
      4.820523,
      4.644727,
      4.439716,
      4.225114,
      4.003017,
      3.772007,
      3.530484,
      3.29719
    ]
  },
  "surprise_weighted": {
    "final_loss": 3.047927,
    "loss_curve": [
      6.082637,
      6.073744,
      6.071032,
      6.067319,
      6.060671,
      6.052037,
      6.036224,
      6.01148,
      5.980287,
      5.94207,
      5.896179,
      5.846613,
      5.792278,
      5.731354,
      5.660333,
      5.585121,
      5.495824,
      5.394218,
      5.28215,
      5.155693,
      5.008058,
      4.845572,
      4.665245,
      4.461962,
      4.248751,
      4.018597,
      3.777693,
      3.530629,
      3.290927,
      3.047927
    ]
  },
  "surprise_decomposition": [
    {
      "0": 55.738626,
      "1": 55.836038,
      "2": 45.378319,
      "3": 47.820696,
      "4": 33.854999,
      "blanket": 13.679633
    },
    {
      "0": 133.696786,
      "1": 136.125375,
      "2": 127.310648,
      "3": 125.567159,
      "4": 65.292841,
      "blanket": 14.458238
    },
    {
      "0": 77.421032,
      "1": 80.410185,
      "2": 95.936191,
      "3": 68.499728,
      "4": 26.265039,
      "blanket": 8.544869
    },
    {
      "0": 55.124804,
      "1": 65.608788,
      "2": 83.251098,
      "3": 48.320027,
      "4": 17.561679,
      "blanket": 6.906836
    },
    {
      "0": 48.193054,
      "1": 59.760858,
      "2": 73.324871,
      "3": 38.091425,
      "4": 14.505427,
      "blanket": 7.196948
    },
    {
      "0": 10.171394,
      "1": 9.433224,
      "2": 16.266954,
      "3": 5.880997,
      "4": 8.092335,
      "blanket": 138.470125
    },
    {
      "0": 10.833476,
      "1": 11.611631,
      "2": 17.949902,
      "3": 7.745091,
      "4": 9.018415,
      "blanket": 89.765453
    },
    {
      "0": 13.872969,
      "1": 13.882556,
      "2": 19.467082,
      "3": 11.705316,
      "4": 13.785943,
      "blanket": 71.671915
    },
    {
      "0": 16.52038,
      "1": 15.892056,
      "2": 22.0018,
      "3": 13.566425,
      "4": 15.475484,
      "blanket": 61.813341
    },
    {
      "0": 18.178578,
      "1": 18.862673,
      "2": 24.383046,
      "3": 16.187116,
      "4": 18.251934,
      "blanket": 59.155371
    },
    {
      "0": 17.145494,
      "1": 18.050826,
      "2": 13.930073,
      "3": 11.641331,
      "4": 6.716242,
      "blanket": 88.840513
    },
    {
      "0": 16.867525,
      "1": 18.096286,
      "2": 14.05546,
      "3": 11.912447,
      "4": 7.175491,
      "blanket": 87.708551
    },
    {
      "0": 16.843729,
      "1": 18.178414,
      "2": 13.439518,
      "3": 12.25768,
      "4": 7.224149,
      "blanket": 86.134446
    },
    {
      "0": 16.794976,
      "1": 18.230836,
      "2": 13.6863,
      "3": 12.026164,
      "4": 7.148064,
      "blanket": 83.992722
    },
    {
      "0": 16.651534,
      "1": 18.212412,
      "2": 13.218442,
      "3": 12.000623,
      "4": 7.524948,
      "blanket": 82.199853
    },
    {
      "0": 27.784731,
      "1": 31.556696,
      "2": 20.763168,
      "3": 12.134214,
      "4": 20.0747,
      "blanket": 34.923277
    },
    {
      "0": 26.461455,
      "1": 29.672883,
      "2": 19.350667,
      "3": 11.580333,
      "4": 18.83547,
      "blanket": 33.868108
    },
    {
      "0": 25.495416,
      "1": 27.972739,
      "2": 18.693361,
      "3": 10.842577,
      "4": 17.688578,
      "blanket": 32.217391
    },
    {
      "0": 24.384933,
      "1": 27.419229,
      "2": 17.860019,
      "3": 10.575216,
      "4": 16.986766,
      "blanket": 31.981446
    },
    {
      "0": 23.499187,
      "1": 26.282067,
      "2": 17.497382,
      "3": 10.329879,
      "4": 16.707729,
      "blanket": 31.591997
    },
    {
      "0": 20.37283,
      "1": 17.926377,
      "2": 15.234152,
      "3": 32.93002,
      "4": 18.799347,
      "blanket": 16.53968
    },
    {
      "0": 19.24312,
      "1": 17.262933,
      "2": 14.677042,
      "3": 31.987697,
      "4": 18.429868,
      "blanket": 16.290198
    },
    {
      "0": 18.755518,
      "1": 16.767068,
      "2": 14.276557,
      "3": 30.984136,
      "4": 17.764168,
      "blanket": 16.400561
    },
    {
      "0": 18.469698,
      "1": 16.610149,
      "2": 13.92655,
      "3": 30.325068,
      "4": 17.451644,
      "blanket": 16.15745
    },
    {
      "0": 17.862931,
      "1": 16.026835,
      "2": 13.502095,
      "3": 29.603742,
      "4": 17.010241,
      "blanket": 16.143338
    },
    {
      "0": 14.663254,
      "1": 27.557414,
      "2": 27.468249,
      "3": 24.343411,
      "4": 6.984763,
      "blanket": 9.189406
    },
    {
      "0": 14.457016,
      "1": 27.639053,
      "2": 27.167895,
      "3": 24.314648,
      "4": 6.957599,
      "blanket": 9.348034
    },
    {
      "0": 14.503578,
      "1": 27.452004,
      "2": 27.179863,
      "3": 24.214709,
      "4": 6.946472,
      "blanket": 9.359565
    },
    {
      "0": 14.488517,
      "1": 27.432839,
      "2": 27.210684,
      "3": 24.474718,
      "4": 7.040303,
      "blanket": 9.697433
    },
    {
      "0": 14.567239,
      "1": 28.027685,
      "2": 27.710853,
      "3": 24.932498,
      "4": 7.146813,
      "blanket": 9.821665
    }
  ],
  "final_tb_comparison": {
    "baseline": {
      "embedding": {
        "eigengap": 93.40147886967368,
        "n_objects": 5,
        "n_blanket": 4
      },
      "layer_1": {
        "eigengap": 102.27133597593846,
        "n_objects": 5,
        "n_blanket": 3
      },
      "layer_2": {
        "eigengap": 99.10308914366784,
        "n_objects": 5,
        "n_blanket": 59
      },
      "layer_3": {
        "eigengap": 94.80321441009104,
        "n_objects": 5,
        "n_blanket": 2
      },
      "layer_4": {
        "eigengap": 92.66817043260785,
        "n_objects": 5,
        "n_blanket": 14
      }
    },
    "surprise_weighted": {
      "embedding": {
        "eigengap": 91.73568080118876,
        "n_objects": 5,
        "n_blanket": 7
      },
      "layer_1": {
        "eigengap": 100.95823635560342,
        "n_objects": 5,
        "n_blanket": 6
      },
      "layer_2": {
        "eigengap": 97.99822701512457,
        "n_objects": 5,
        "n_blanket": 2
      },
      "layer_3": {
        "eigengap": 94.73195708533841,
        "n_objects": 5,
        "n_blanket": 46
      },
      "layer_4": {
        "eigengap": 89.20898673376459,
        "n_objects": 5,
        "n_blanket": 5
      }
    }
  },
  "free_energy_connection": {
    "formalization": "Per-factor surprise S_n = ||proj_n(epsilon)||^2 corresponds to factor-specific free energy. Total free energy decomposes as S_total = sum_n S_n under the TB partition. Gradient weighting by S_n concentration implements factor-specific epistemic foraging: updating the most surprising factor while preserving well-predicted factors.",
    "correspondence": {
      "prediction_error": "epsilon = residual stream activation",
      "factor_projection": "proj_n = TB object n subspace projector",
      "factor_free_energy": "S_n = ||proj_n(epsilon)||^2",
      "epistemic_action": "gradient scaling by surprise concentration"
    }
  },
  "summary": {
    "baseline_final_loss": 3.29719,
    "surprise_final_loss": 3.047927,
    "loss_improvement": 7.56,
    "convergence_advantage": "surprise"
  }
}