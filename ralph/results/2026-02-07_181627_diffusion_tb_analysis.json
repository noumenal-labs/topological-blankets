{
  "timestamp": "2026-02-07T18:16:27.335606",
  "experiment_name": "diffusion_tb_analysis",
  "config": {
    "dataset": "make_moons",
    "n_samples": 1000,
    "noise": 0.08,
    "T": 100,
    "schedule": "cosine (Nichol & Dhariwal 2021)",
    "score_model": "MLPRegressor(256,256,128)",
    "parameterization": "epsilon (predict noise)",
    "n_sigma_levels": 10,
    "n_augment": 6,
    "sample_sub_n": 400,
    "cluster_detection": "k-means + silhouette on combined position+score features",
    "silhouette_threshold": 0.4,
    "eigengap": "lambda_2 - lambda_1 of normalized Laplacian"
  },
  "metrics": {
    "sigma_levels": [
      0.025125317875435788,
      0.19776896498078492,
      0.36225173063201443,
      0.5159957894859069,
      0.6545787371746979,
      0.7739578504428853,
      0.8706408733452655,
      0.941796947350938,
      0.9853418764183612,
      1.0
    ],
    "per_sigma": {
      "sigma_0.0251": {
        "sigma": 0.025125317875435788,
        "sample_eigengap": 0.29009439742724985,
        "sample_silhouette": 0.42058061624000415,
        "sample_n_clusters": 2,
        "sample_eigenvalues": [
          7.212008767965017e-13,
          0.3751309519427255,
          0.6652253493699753,
          0.78498412504862,
          0.8137121239613508,
          0.9146473851464265,
          0.9224303700933871,
          0.9331609933677577,
          0.9450595969191,
          0.9625997803033909,
          0.9638261035775316
        ],
        "var_hessian_est": [
          [
            108.1419178983147,
            -6.609879079084461
          ],
          [
            -6.609879079084461,
            46.89227944873053
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.09282090694367981
          ],
          [
            0.09282090694367981,
            0.0
          ]
        ],
        "var_coupling_strength": 0.09282090694367981,
        "ari": 0.47478419619678774
      },
      "sigma_0.1978": {
        "sigma": 0.19776896498078492,
        "sample_eigengap": 0.2733241978420532,
        "sample_silhouette": 0.41152692368794264,
        "sample_n_clusters": 2,
        "sample_eigenvalues": [
          7.174261185127762e-13,
          0.39679256362435866,
          0.6701167614664119,
          0.7952550754127967,
          0.8296444507265494,
          0.9072195600448192,
          0.9135354354402024,
          0.9237510032009226,
          0.9482664812922275,
          0.9506985729708051,
          0.9628511723646231
        ],
        "var_hessian_est": [
          [
            10.383525430388184,
            -0.10536625897901074
          ],
          [
            -0.10536625897901074,
            6.3643095293062055
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.012961447213235161
          ],
          [
            0.012961447213235161,
            0.0
          ]
        ],
        "var_coupling_strength": 0.012961447213235161,
        "ari": 0.4957615287780302
      },
      "sigma_0.3623": {
        "sigma": 0.36225173063201443,
        "sample_eigengap": 0.20375701883744313,
        "sample_silhouette": 0.382806693054516,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          7.007727731433988e-13,
          0.44521230279644763,
          0.6489693216338908,
          0.8005039466147279,
          0.8219586384772917,
          0.8844091409935735,
          0.9015522107617011,
          0.9255649923808419,
          0.9541174780968331,
          0.9635452469031027,
          0.9685633911836394
        ],
        "var_hessian_est": [
          [
            2.4896139829236854,
            -0.024955521173878864
          ],
          [
            -0.024955521173878864,
            2.4712555233125557
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.010061015194312035
          ],
          [
            0.010061015194312035,
            0.0
          ]
        ],
        "var_coupling_strength": 0.010061015194312035,
        "ari": 0.0
      },
      "sigma_0.5160": {
        "sigma": 0.5159957894859069,
        "sample_eigengap": 0.13551140380553717,
        "sample_silhouette": 0.3516502978175214,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          7.238654120556021e-13,
          0.4484331599867801,
          0.5839445637923173,
          0.7654514846291323,
          0.8001042840691996,
          0.8762761705030103,
          0.905552017326433,
          0.9262317026848983,
          0.9370688972980834,
          0.9676017742686532,
          0.9720379961917491
        ],
        "var_hessian_est": [
          [
            1.529994902870144,
            0.26894592679494445
          ],
          [
            0.26894592679494445,
            1.6092286618724585
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.17140010859328067
          ],
          [
            0.17140010859328067,
            0.0
          ]
        ],
        "var_coupling_strength": 0.17140010859328067,
        "ari": 0.0
      },
      "sigma_0.6546": {
        "sigma": 0.6545787371746979,
        "sample_eigengap": 0.05972657891091504,
        "sample_silhouette": 0.3370036745107786,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          7.602807272633072e-13,
          0.44873388710577533,
          0.5084604660166904,
          0.7568572259710868,
          0.7914230089760211,
          0.847803515466574,
          0.9054422701569376,
          0.916841864096255,
          0.9248945167915025,
          0.946477116991644,
          0.9712591055881552
        ],
        "var_hessian_est": [
          [
            1.2838982860916432,
            0.18308501220727597
          ],
          [
            0.18308501220727597,
            1.2955104700276836
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.14196033401856473
          ],
          [
            0.14196033401856473,
            0.0
          ]
        ],
        "var_coupling_strength": 0.14196033401856473,
        "ari": 0.0
      },
      "sigma_0.7740": {
        "sigma": 0.7739578504428853,
        "sample_eigengap": 0.009994021475607351,
        "sample_silhouette": 0.33391664892404194,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          7.8026474170656e-13,
          0.45247869102391647,
          0.4624727124995238,
          0.7593187382914757,
          0.7830884323802898,
          0.8456564273632766,
          0.905549632758341,
          0.9123912252746139,
          0.9268459252036294,
          0.9292995437552626,
          0.9714108416184233
        ],
        "var_hessian_est": [
          [
            1.0735945446416173,
            0.20967974190479313
          ],
          [
            0.20967974190479313,
            1.0581898457255705
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.19672272067329577
          ],
          [
            0.19672272067329577,
            0.0
          ]
        ],
        "var_coupling_strength": 0.19672272067329577,
        "ari": 0.0
      },
      "sigma_0.8706": {
        "sigma": 0.8706408733452655,
        "sample_eigengap": 0.011525909815174429,
        "sample_silhouette": 0.34735800582217324,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          7.907008381380365e-13,
          0.43993518375205143,
          0.45146109356722586,
          0.7662428552477403,
          0.7918879906031558,
          0.8512304302541747,
          0.897821736971797,
          0.9146579544612286,
          0.9220847225092977,
          0.9363516805911914,
          0.9636553328368769
        ],
        "var_hessian_est": [
          [
            1.0393380577419564,
            0.1795941930702115
          ],
          [
            0.1795941930702115,
            1.1338895486529479
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.16543541705714815
          ],
          [
            0.16543541705714815,
            0.0
          ]
        ],
        "var_coupling_strength": 0.16543541705714815,
        "ari": 0.0
      },
      "sigma_0.9418": {
        "sigma": 0.941796947350938,
        "sample_eigengap": 0.08048218175474808,
        "sample_silhouette": 0.3871973082440746,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          8.195666367782906e-13,
          0.3646148046592257,
          0.44509698641397377,
          0.7629219315479123,
          0.7754612443777633,
          0.8778475614667266,
          0.9045040125980948,
          0.9210679979236407,
          0.9286878071536095,
          0.9352923839443736,
          0.9639026083719789
        ],
        "var_hessian_est": [
          [
            1.0635483128383427,
            0.08935937974499415
          ],
          [
            0.08935937974499415,
            0.9960820121464776
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.08681883959915043
          ],
          [
            0.08681883959915043,
            0.0
          ]
        ],
        "var_coupling_strength": 0.08681883959915043,
        "ari": 0.0
      },
      "sigma_0.9853": {
        "sigma": 0.9853418764183612,
        "sample_eigengap": 0.02995635558178944,
        "sample_silhouette": 0.400757163561306,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          9.128253708468037e-13,
          0.27144679665134797,
          0.3014031522331374,
          0.6736640124449669,
          0.6883958054797409,
          0.8946579258761664,
          0.9041187405523162,
          0.9486558066080565,
          0.9531037947058357,
          0.9621250073680033,
          0.9760281132686434
        ],
        "var_hessian_est": [
          [
            1.0841550526504817,
            0.1153556508595339
          ],
          [
            0.1153556508595339,
            0.9971131076031738
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.11094837701805568
          ],
          [
            0.11094837701805568,
            0.0
          ]
        ],
        "var_coupling_strength": 0.11094837701805568,
        "ari": 0.0
      },
      "sigma_1.0000": {
        "sigma": 1.0,
        "sample_eigengap": 0.06897360519037432,
        "sample_silhouette": 0.4470473102921219,
        "sample_n_clusters": 1,
        "sample_eigenvalues": [
          9.565681580170349e-13,
          0.18877250555587477,
          0.2577461107462491,
          0.5872929942486067,
          0.6071306706631643,
          0.8407932819083135,
          0.8553468510817098,
          0.9597542025966352,
          0.9618161321514982,
          0.997182235773817,
          0.9975679458318903
        ],
        "var_hessian_est": [
          [
            1.0721263863080646,
            -0.0027021304562121562
          ],
          [
            -0.0027021304562121562,
            0.9533825178198311
          ]
        ],
        "var_coupling": [
          [
            0.0,
            0.00267269695913502
          ],
          [
            0.00267269695913502,
            0.0
          ]
        ],
        "var_coupling_strength": 0.00267269695913502,
        "ari": 0.0
      }
    },
    "structure_emergence": {
      "clusters_vs_sigma": [
        [
          0.025125317875435788,
          2
        ],
        [
          0.19776896498078492,
          2
        ],
        [
          0.36225173063201443,
          1
        ],
        [
          0.5159957894859069,
          1
        ],
        [
          0.6545787371746979,
          1
        ],
        [
          0.7739578504428853,
          1
        ],
        [
          0.8706408733452655,
          1
        ],
        [
          0.941796947350938,
          1
        ],
        [
          0.9853418764183612,
          1
        ],
        [
          1.0,
          1
        ]
      ],
      "eigengap_vs_sigma": [
        [
          0.025125317875435788,
          0.29009439742724985
        ],
        [
          0.19776896498078492,
          0.2733241978420532
        ],
        [
          0.36225173063201443,
          0.20375701883744313
        ],
        [
          0.5159957894859069,
          0.13551140380553717
        ],
        [
          0.6545787371746979,
          0.05972657891091504
        ],
        [
          0.7739578504428853,
          0.009994021475607351
        ],
        [
          0.8706408733452655,
          0.011525909815174429
        ],
        [
          0.941796947350938,
          0.08048218175474808
        ],
        [
          0.9853418764183612,
          0.02995635558178944
        ],
        [
          1.0,
          0.06897360519037432
        ]
      ],
      "silhouette_vs_sigma": [
        [
          0.025125317875435788,
          0.42058061624000415
        ],
        [
          0.19776896498078492,
          0.41152692368794264
        ],
        [
          0.36225173063201443,
          0.382806693054516
        ],
        [
          0.5159957894859069,
          0.3516502978175214
        ],
        [
          0.6545787371746979,
          0.3370036745107786
        ],
        [
          0.7739578504428853,
          0.33391664892404194
        ],
        [
          0.8706408733452655,
          0.34735800582217324
        ],
        [
          0.941796947350938,
          0.3871973082440746
        ],
        [
          0.9853418764183612,
          0.400757163561306
        ],
        [
          1.0,
          0.4470473102921219
        ]
      ],
      "ari_vs_sigma": [
        [
          0.025125317875435788,
          0.47478419619678774
        ],
        [
          0.19776896498078492,
          0.4957615287780302
        ],
        [
          0.36225173063201443,
          0.0
        ],
        [
          0.5159957894859069,
          0.0
        ],
        [
          0.6545787371746979,
          0.0
        ],
        [
          0.7739578504428853,
          0.0
        ],
        [
          0.8706408733452655,
          0.0
        ],
        [
          0.941796947350938,
          0.0
        ],
        [
          0.9853418764183612,
          0.0
        ],
        [
          1.0,
          0.0
        ]
      ],
      "coupling_vs_sigma": [
        [
          0.025125317875435788,
          0.09282090694367981
        ],
        [
          0.19776896498078492,
          0.012961447213235161
        ],
        [
          0.36225173063201443,
          0.010061015194312035
        ],
        [
          0.5159957894859069,
          0.17140010859328067
        ],
        [
          0.6545787371746979,
          0.14196033401856473
        ],
        [
          0.7739578504428853,
          0.19672272067329577
        ],
        [
          0.8706408733452655,
          0.16543541705714815
        ],
        [
          0.941796947350938,
          0.08681883959915043
        ],
        [
          0.9853418764183612,
          0.11094837701805568
        ],
        [
          1.0,
          0.00267269695913502
        ]
      ]
    },
    "topological_transition_sigma": 0.2637844619205456,
    "comparison_to_us019": {
      "us019_ari": 0.0705727047350898,
      "us019_eigengap": 0.14235830853922926,
      "us019_n_clusters": 2,
      "us019_coupling_strength": 0.029343740092034703,
      "best_ddpm_ari": 0.4957615287780302,
      "best_ddpm_sigma": 0.19776896498078492,
      "ddpm_better": true
    },
    "acceptance": {
      "high_noise_1_cluster": true,
      "low_noise_2_clusters": true,
      "eigengap_increases_at_low_noise": true,
      "low_noise_ari_positive": true,
      "transition_sigma_found": true
    }
  },
  "notes": "US-052: TB applied to DDPM epsilon model at multiple noise levels. Structure crystallizes from noise along the reverse diffusion trajectory. Uses combined position+score direction features for clustering, weighted by sqrt(alpha_bar) so position dominates at low noise and both features randomize at high noise, producing a natural 1-to-2 cluster transition."
}