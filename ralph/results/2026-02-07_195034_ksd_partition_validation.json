{
  "timestamp": "2026-02-07T19:50:34.574892",
  "experiment_name": "ksd_partition_validation",
  "config": {
    "n_permutations": 1000,
    "max_samples": 500,
    "quadratic_config": {
      "n_objects": 2,
      "vars_per_object": 3,
      "vars_per_blanket": 3,
      "intra_strength": 6.0,
      "blanket_strength": 0.8,
      "n_samples": 3000
    }
  },
  "metrics": {
    "quadratic_validation": {
      "config": {
        "n_objects": 2,
        "vars_per_object": 3,
        "vars_per_blanket": 3,
        "intra_strength": 6.0,
        "blanket_strength": 0.8,
        "n_samples": 3000
      },
      "correct_partition": {
        "idx_A": [
          0,
          1,
          2
        ],
        "idx_B": [
          3,
          4,
          5
        ],
        "idx_M": [
          6,
          7,
          8
        ],
        "test_stat_AB": 0.00040914938796329813,
        "test_stat_BA": 0.0005573152583676105,
        "p_value_AB": 0.192,
        "p_value_BA": 0.026,
        "p_value": 0.052,
        "reject_at_005": false,
        "time": 36.08777737617493
      },
      "random_partition": {
        "idx_A": [
          7,
          0,
          5
        ],
        "idx_B": [
          6,
          3,
          1
        ],
        "idx_M": [
          8,
          4,
          2
        ],
        "test_stat_AB": 0.0003818997447858996,
        "test_stat_BA": 0.00039549316679660996,
        "p_value_AB": 0.368,
        "p_value_BA": 0.329,
        "p_value": 0.658,
        "reject_at_005": false,
        "time": 32.19813370704651
      },
      "tb_detected_partition": {
        "idx_A": [
          0,
          1,
          2,
          7
        ],
        "idx_B": [
          3,
          4,
          5
        ],
        "idx_M": [
          6,
          8
        ],
        "test_stat_AB": 0.00037563609629340304,
        "test_stat_BA": 0.0003483106306298479,
        "p_value_AB": 0.295,
        "p_value_BA": 0.459,
        "p_value": 0.59,
        "reject_at_005": false,
        "time": 25.969473361968994
      }
    },
    "power_analysis": {
      "100": {
        "correct_rejection_rate": 0.6,
        "random_rejection_rate": 0.4,
        "correct_mean_pvalue": 0.2352,
        "correct_std_pvalue": 0.31240896273954755,
        "random_mean_pvalue": 0.2976,
        "random_std_pvalue": 0.34881834814126395,
        "correct_pvals": [
          0.004,
          0.7,
          0.004,
          0.048,
          0.796,
          0.0,
          0.196,
          0.0,
          0.0,
          0.604
        ],
        "random_pvals": [
          0.0,
          0.548,
          0.884,
          0.052,
          0.0,
          0.412,
          0.0,
          0.176,
          0.0,
          0.904
        ]
      },
      "200": {
        "correct_rejection_rate": 0.2,
        "random_rejection_rate": 0.4,
        "correct_mean_pvalue": 0.398,
        "correct_std_pvalue": 0.3541671921564729,
        "random_mean_pvalue": 0.3712,
        "random_std_pvalue": 0.3770954255888024,
        "correct_pvals": [
          0.064,
          1.0,
          0.42,
          0.628,
          0.348,
          0.32,
          1.0,
          0.0,
          0.0,
          0.2
        ],
        "random_pvals": [
          0.024,
          1.0,
          0.456,
          0.5,
          0.04,
          0.112,
          0.0,
          0.572,
          0.008,
          1.0
        ]
      },
      "500": {
        "correct_rejection_rate": 0.1,
        "random_rejection_rate": 0.1,
        "correct_mean_pvalue": 0.5523999999999999,
        "correct_std_pvalue": 0.32843118000579663,
        "random_mean_pvalue": 0.41159999999999997,
        "random_std_pvalue": 0.31362882520584745,
        "correct_pvals": [
          0.044,
          0.824,
          0.976,
          0.492,
          0.528,
          0.82,
          0.244,
          0.116,
          0.48,
          1.0
        ],
        "random_pvals": [
          0.248,
          0.356,
          0.704,
          0.652,
          0.068,
          0.148,
          0.032,
          0.708,
          1.0,
          0.2
        ]
      },
      "1000": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.1,
        "correct_mean_pvalue": 0.5828,
        "correct_std_pvalue": 0.3440467410105784,
        "random_mean_pvalue": 0.5084000000000001,
        "random_std_pvalue": 0.31355229228949993,
        "correct_pvals": [
          0.208,
          1.0,
          0.356,
          0.356,
          0.992,
          0.244,
          0.42,
          0.252,
          1.0,
          1.0
        ],
        "random_pvals": [
          0.768,
          0.744,
          0.468,
          0.172,
          0.132,
          1.0,
          0.0,
          0.752,
          0.672,
          0.376
        ]
      },
      "2000": {
        "correct_rejection_rate": 0.0,
        "random_rejection_rate": 0.3,
        "correct_mean_pvalue": 0.6688,
        "correct_std_pvalue": 0.29637165856404013,
        "random_mean_pvalue": 0.2816,
        "random_std_pvalue": 0.32869292660475674,
        "correct_pvals": [
          1.0,
          0.648,
          0.436,
          0.22,
          0.516,
          1.0,
          1.0,
          1.0,
          0.276,
          0.592
        ],
        "random_pvals": [
          0.112,
          0.044,
          0.008,
          0.36,
          0.8,
          0.208,
          1.0,
          0.016,
          0.204,
          0.064
        ]
      },
      "3000": {
        "correct_rejection_rate": 0.1,
        "random_rejection_rate": 0.1,
        "correct_mean_pvalue": 0.5616,
        "correct_std_pvalue": 0.4051200315955754,
        "random_mean_pvalue": 0.5396,
        "random_std_pvalue": 0.3504623232246228,
        "correct_pvals": [
          0.176,
          1.0,
          0.104,
          0.208,
          1.0,
          1.0,
          1.0,
          0.364,
          0.76,
          0.004
        ],
        "random_pvals": [
          0.576,
          1.0,
          0.316,
          0.148,
          0.172,
          0.048,
          0.5,
          1.0,
          1.0,
          0.636
        ]
      }
    },
    "lunarlander_validation": {
      "n_samples": 3000,
      "n_vars": 8,
      "state_labels": [
        "x",
        "y",
        "vx",
        "vy",
        "angle",
        "ang_vel",
        "left_leg",
        "right_leg"
      ],
      "data_source": "synthetic_lunarlander_8d",
      "tb_partition": {
        "assignment": [
          0,
          0,
          -1,
          0,
          1,
          -1,
          -1,
          0
        ],
        "is_blanket": [
          false,
          false,
          true,
          false,
          false,
          true,
          true,
          false
        ],
        "blanket_vars": [
          2,
          5,
          6
        ]
      },
      "tb_validation": {
        "partition_valid": true,
        "min_pvalue": 0.54,
        "mean_pvalue": 0.54,
        "pair_results": {
          "obj0_vs_obj1": {
            "test_stat_AB": 0.0003311188691723664,
            "p_value_AB": 0.55,
            "test_stat_BA": 0.0004293959565457564,
            "p_value_BA": 0.27,
            "combined_p_value": 0.54,
            "n_samples_used": 500,
            "dim_A": 4,
            "dim_B": 1,
            "dim_M": 3,
            "reject_at_005": false,
            "reject_at_001": false,
            "n_permutations": 500
          }
        }
      },
      "random_validation": {
        "partition_valid": true,
        "min_pvalue": 0.148,
        "mean_pvalue": 0.148,
        "pair_results": {
          "obj0_vs_obj1": {
            "test_stat_AB": 0.00036499814534124463,
            "p_value_AB": 0.288,
            "test_stat_BA": 0.00048118836372892384,
            "p_value_BA": 0.074,
            "combined_p_value": 0.148,
            "n_samples_used": 500,
            "dim_A": 3,
            "dim_B": 3,
            "dim_M": 2,
            "reject_at_005": false,
            "reject_at_001": false,
            "n_permutations": 500
          }
        }
      }
    },
    "integration_test": {
      "partition_valid": true,
      "mean_pvalue": 1.0,
      "min_pvalue": 1.0
    },
    "summary": {
      "acceptance_criteria": {
        "correct_partition_not_rejected": true,
        "random_partition_rejected": false,
        "tb_partition_not_rejected": true,
        "power_crossover_N": null,
        "integration_works": true
      },
      "total_time_seconds": 1402.4526731967926
    }
  },
  "notes": "US-074: KSD goodness-of-fit test for partition validation. Correct partition p=0.0520 (not rejected=True), random partition p=0.6580 (rejected=False), TB partition p=0.5900 (not rejected=True). Power crossover at N=None. Integration test: valid=True."
}